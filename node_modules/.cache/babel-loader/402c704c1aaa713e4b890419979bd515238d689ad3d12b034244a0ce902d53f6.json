{"ast":null,"code":"// ============================================================\n//  CSV обработка\n// ============================================================\n\nexport const processCSVData = file => {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = e => {\n      try {\n        const csvText = e.target.result;\n        const results = parseCSV(csvText);\n        resolve(results);\n      } catch (error) {\n        reject(error);\n      }\n    };\n    reader.onerror = () => reject(new Error(\"Ошибка чтения файла\"));\n    reader.readAsText(file);\n  });\n};\n\n// ============================================================\n//  МАТРИЧНЫЕ УТИЛИТЫ\n// ============================================================\n\nconst transpose = M => M[0].map((_, i) => M.map(row => row[i]));\nconst multiplyMatrices = (A, B) => {\n  const aRows = A.length,\n    aCols = A[0].length,\n    bCols = B[0].length;\n  const C = Array.from({\n    length: aRows\n  }, () => Array(bCols).fill(0));\n  for (let i = 0; i < aRows; i++) {\n    for (let k = 0; k < aCols; k++) {\n      let v = A[i][k];\n      for (let j = 0; j < bCols; j++) C[i][j] += v * B[k][j];\n    }\n  }\n  return C;\n};\nconst invertMatrix = m => {\n  const n = m.length;\n  const A = m.map((row, i) => row.concat(Array.from({\n    length: n\n  }, (_, j) => i === j ? 1 : 0)));\n  for (let i = 0; i < n; i++) {\n    let maxRow = i;\n    for (let k = i + 1; k < n; k++) {\n      if (Math.abs(A[k][i]) > Math.abs(A[maxRow][i])) maxRow = k;\n    }\n    if (Math.abs(A[maxRow][i]) < 1e-15) throw new Error(\"Матрица вырождена\");\n    if (maxRow !== i) [A[i], A[maxRow]] = [A[maxRow], A[i]];\n    const diag = A[i][i];\n    for (let j = 0; j < 2 * n; j++) A[i][j] /= diag;\n    for (let k = 0; k < n; k++) {\n      if (k === i) continue;\n      let factor = A[k][i];\n      for (let j = 0; j < 2 * n; j++) A[k][j] -= factor * A[i][j];\n    }\n  }\n  return A.map(row => row.slice(n));\n};\n\n// ============================================================\n//  SAVITZKY–GOLAY\n// ============================================================\n\nconst savitzkyGolay = (data, windowSize = 31, polyOrder = 3) => {\n  if (!Array.isArray(data) || data.length === 0) return [];\n  windowSize = Math.max(3, Math.floor(windowSize));\n  if (windowSize % 2 === 0) windowSize += 1;\n  polyOrder = Math.max(1, Math.floor(polyOrder));\n  if (polyOrder >= windowSize) polyOrder = windowSize - 1;\n  const n = data.length;\n  const half = Math.floor(windowSize / 2);\n  const A = [];\n  for (let i = -half; i <= half; i++) {\n    const row = [];\n    for (let p = 0; p <= polyOrder; p++) row.push(i ** p);\n    A.push(row);\n  }\n  const AT = transpose(A);\n  const ATA = multiplyMatrices(AT, A);\n  let invATA;\n  try {\n    invATA = invertMatrix(ATA);\n  } catch {\n    return data.slice();\n  }\n  const coeffs = multiplyMatrices(invATA, AT)[0];\n  const out = new Array(n).fill(0);\n  for (let i = 0; i < n; i++) {\n    let sum = 0;\n    for (let j = -half; j <= half; j++) {\n      const idx = Math.min(n - 1, Math.max(0, i + j));\n      sum += data[idx] * coeffs[j + half];\n    }\n    out[i] = sum;\n  }\n  return out;\n};\n\n// ============================================================\n//  SG производная\n// ============================================================\n\nconst calculateDerivativeSG = (t, signal, windowSize = 31, polyOrder = 3) => {\n  const n = signal.length;\n  if (n < 5) return new Array(n).fill(0);\n  const half = Math.floor(windowSize / 2);\n  const A = [];\n  for (let i = -half; i <= half; i++) {\n    const row = [];\n    for (let p = 0; p <= polyOrder; p++) row.push(i ** p);\n    A.push(row);\n  }\n  const AT = transpose(A);\n  const ATA = multiplyMatrices(AT, A);\n  let invATA;\n  try {\n    invATA = invertMatrix(ATA);\n  } catch {\n    return new Array(n).fill(0);\n  }\n  const coeffsDeriv = multiplyMatrices(invATA, AT)[1];\n  const dt = t[1] - t[0];\n  const out = new Array(n).fill(0);\n  for (let i = 0; i < n; i++) {\n    let sum = 0;\n    for (let j = -half; j <= half; j++) {\n      const idx = Math.min(n - 1, Math.max(0, i + j));\n      sum += signal[idx] * coeffsDeriv[j + half];\n    }\n    out[i] = sum / dt;\n  }\n  return out;\n};\n\n// ============================================================\n//  Базовая коррекция\n// ============================================================\n\nconst removeBaseline = (arr, N = 2000) => {\n  if (!Array.isArray(arr) || arr.length === 0) return [];\n  const c = Math.min(N, arr.length);\n  const avg = arr.slice(0, c).reduce((s, x) => s + x, 0) / c;\n  return arr.map(v => v - avg);\n};\n\n// ============================================================\n//  Нулевые пересечения\n// ============================================================\n\nconst findZeroCrossings = (t, y, eps = 1e-6) => {\n  const resT = [];\n  const resY = [];\n  for (let i = 1; i < y.length; i++) {\n    const y1 = y[i - 1],\n      y2 = y[i];\n    const t1 = t[i - 1],\n      t2 = t[i];\n    if (Math.abs(y1) < eps) {\n      resT.push(t1);\n      resY.push(0);\n      continue;\n    }\n    if (Math.abs(y2) < eps) {\n      resT.push(t2);\n      resY.push(0);\n      continue;\n    }\n    if (y1 * y2 < 0) {\n      const x0 = t1 - y1 * (t2 - t1) / (y2 - y1);\n      resT.push(x0);\n      resY.push(0);\n    }\n  }\n  return {\n    t0: resT,\n    y0: resY\n  };\n};\n\n// ============================================================\n//  Фильтрация близких точек\n// ============================================================\n\nconst filterClosePoints = (t0, y0, minDist) => {\n  if (!t0.length) return {\n    filteredT0: [],\n    filteredY0: []\n  };\n  let nt = [t0[0]];\n  let ny = [y0[0]];\n  for (let i = 1; i < t0.length; i++) {\n    if (t0[i] - nt[nt.length - 1] >= minDist) {\n      nt.push(t0[i]);\n      ny.push(y0[i]);\n    }\n  }\n  return {\n    filteredT0: nt,\n    filteredY0: ny\n  };\n};\n\n// ============================================================\n//  Пересечение сигналов\n// ============================================================\n\nconst findSignalIntersectionsAtZero = (t, tenz, interf, threshold = 0.02) => {\n  const pts = [];\n  for (let i = 1; i < t.length; i++) {\n    const d1 = tenz[i - 1] - interf[i - 1];\n    const d2 = tenz[i] - interf[i];\n    if (d1 <= 0 && d2 > 0 || d1 >= 0 && d2 < 0) {\n      const ratio = -d1 / (d2 - d1);\n      const x = t[i - 1] + ratio * (t[i] - t[i - 1]);\n      const y = (tenz[i - 1] + ratio * (tenz[i] - tenz[i - 1]) + interf[i - 1] + ratio * (interf[i] - interf[i - 1])) / 2;\n      if (Math.abs(y) <= threshold) pts.push({\n        time: x,\n        value: y\n      });\n    }\n  }\n  return pts;\n};\n\n// ============================================================\n//  CSV парсинг\n// ============================================================\n\nconst parseCSV = (csvText, options = {}) => {\n  const sgWindow = options.sgWindow || 31;\n  const sgPoly = options.sgPoly || 3;\n  const baselineN = options.baselineN || 2000;\n  const skipStart = options.skipStart || 6650;\n  const skipEnd = options.skipEnd || 27000;\n  const lines = csvText.split(\"\\n\");\n  const t = [];\n  const tenz = [];\n  const interf = [];\n  let started = false;\n  let counter = 0;\n  for (let line of lines) {\n    line = line.trim();\n    if (!line) continue;\n    if (line.startsWith(\"TIME,CH1\")) {\n      started = true;\n      continue;\n    }\n    if (!started) continue;\n    counter++;\n    if (counter < skipStart) continue;\n    if (counter > skipEnd) break;\n    const f = line.split(\",\");\n    if (f.length < 5) continue;\n    const timeVal = parseFloat(f[0]);\n    const ch1Val = parseFloat(f[1]);\n    const ch3Val = parseFloat(f[3]);\n    if (isNaN(timeVal)) continue;\n    t.push(timeVal);\n    tenz.push(ch1Val * 0.00132 * 1.25);\n    interf.push(ch3Val + 0.04);\n  }\n  const interfSmoothed = savitzkyGolay(interf, sgWindow, sgPoly);\n  const interfCorrected = removeBaseline(interfSmoothed, baselineN);\n  const {\n    t0,\n    y0\n  } = findZeroCrossings(t, interfCorrected);\n  const {\n    filteredT0,\n    filteredY0\n  } = filterClosePoints(t0, y0, 100e-9);\n  const dudt_interf = calculateDerivativeSG(t, interfCorrected, sgWindow, sgPoly);\n  const intersectionPoints = findSignalIntersectionsAtZero(t, tenz, interfCorrected);\n  return {\n    t,\n    tenz,\n    interf,\n    interfSmoothed,\n    interfCorrected,\n    t0: filteredT0,\n    y0: filteredY0,\n    dudt_interf,\n    intersectionPoints\n  };\n};\n\n// ============================================================\n//  ФУНКЦИЯ ТРАНСФОРМАЦИИ ДАННЫХ ПО OY\n// ============================================================\n\nconst applyYAxisTransform = (arr, yOffset, yScale) => {\n  return arr.map(v => v * yScale + yOffset);\n};\n\n// ============================================================\n//  ПОДГОТОВКА ДАННЫХ ДЛЯ ГРАФИКОВ\n// ============================================================\n\nexport const generateChartData = (results, options = {}) => {\n  const {\n    t,\n    tenz,\n    interfSmoothed,\n    interfCorrected,\n    dudt_interf,\n    intersectionPoints\n  } = results;\n  const maxPoints = options.maxPoints || 2000;\n  const step = Math.max(1, Math.floor(t.length / maxPoints));\n  const yOffset = options.yOffset || 0;\n  const yScale = options.yScale || 1;\n  const T = [];\n  const TZ = [];\n  const IF = [];\n  const IFs = [];\n  const DUDT = [];\n  for (let i = 0; i < t.length; i += step) {\n    T.push(t[i]);\n    TZ.push(tenz[i]);\n    IF.push(interfCorrected[i]);\n    IFs.push(interfSmoothed[i]);\n    DUDT.push(dudt_interf[i]);\n  }\n\n  // применяем масштабирование и смещение\n  const TZt = applyYAxisTransform(TZ, yOffset, yScale);\n  const IFt = applyYAxisTransform(IF, yOffset, yScale);\n  const IFst = applyYAxisTransform(IFs, yOffset, yScale);\n  const DUDTt = applyYAxisTransform(DUDT, yOffset, yScale);\n  const intersectionDerivative = (intersectionPoints || []).map(({\n    time\n  }) => ({\n    x: time,\n    y: applyYAxisTransform([dudt_interf[Math.floor(dudt_interf.length / 2)]], yOffset, yScale)[0]\n  }));\n  const chartData = {\n    original: [{\n      label: \"Тензометрический сигнал\",\n      data: T.map((time, i) => ({\n        x: time,\n        y: TZt[i]\n      })),\n      borderColor: \"rgb(255,99,132)\",\n      backgroundColor: \"rgba(255,99,132,0.1)\",\n      borderWidth: 1,\n      tension: 0.1\n    }, {\n      label: \"Интерферометрический сигнал (сглаженный)\",\n      data: T.map((time, i) => ({\n        x: time,\n        y: IFst[i]\n      })),\n      borderColor: \"black\",\n      backgroundColor: \"rgba(0,0,0,0.05)\",\n      borderWidth: 1,\n      tension: 0.1\n    }, {\n      label: \"Интерферометрический (центрированный)\",\n      data: T.map((time, i) => ({\n        x: time,\n        y: IFt[i]\n      })),\n      borderColor: \"rgb(54,162,235)\",\n      backgroundColor: \"rgba(54,162,235,0.1)\",\n      borderWidth: 1,\n      tension: 0.1\n    }],\n    processed: [{\n      label: \"Производная интерферометра\",\n      data: T.map((time, i) => ({\n        x: time,\n        y: DUDTt[i]\n      })),\n      borderColor: \"rgb(75,192,192)\",\n      backgroundColor: \"rgba(75,192,192,0.1)\",\n      borderWidth: 2,\n      pointRadius: 0,\n      showLine: true\n    }, {\n      label: \"Скорректированный тензосигнал\",\n      data: T.map((time, i) => ({\n        x: time,\n        y: TZt[i]\n      })),\n      borderColor: \"rgb(153,102,255)\",\n      backgroundColor: \"rgba(153,102,255,0.1)\",\n      borderWidth: 1,\n      tension: 0.1\n    }, {\n      label: \"Пересечения\",\n      data: intersectionDerivative,\n      pointStyle: \"crossRot\",\n      pointRadius: 4,\n      borderColor: \"rgb(75,192,192)\",\n      showLine: false\n    }],\n    rawData: {\n      t: T,\n      tenz: TZt,\n      interf: IFt,\n      dudt: DUDTt\n    }\n  };\n  return chartData;\n};","map":{"version":3,"names":["processCSVData","file","Promise","resolve","reject","reader","FileReader","onload","e","csvText","target","result","results","parseCSV","error","onerror","Error","readAsText","transpose","M","map","_","i","row","multiplyMatrices","A","B","aRows","length","aCols","bCols","C","Array","from","fill","k","v","j","invertMatrix","m","n","concat","maxRow","Math","abs","diag","factor","slice","savitzkyGolay","data","windowSize","polyOrder","isArray","max","floor","half","p","push","AT","ATA","invATA","coeffs","out","sum","idx","min","calculateDerivativeSG","t","signal","coeffsDeriv","dt","removeBaseline","arr","N","c","avg","reduce","s","x","findZeroCrossings","y","eps","resT","resY","y1","y2","t1","t2","x0","t0","y0","filterClosePoints","minDist","filteredT0","filteredY0","nt","ny","findSignalIntersectionsAtZero","tenz","interf","threshold","pts","d1","d2","ratio","time","value","options","sgWindow","sgPoly","baselineN","skipStart","skipEnd","lines","split","started","counter","line","trim","startsWith","f","timeVal","parseFloat","ch1Val","ch3Val","isNaN","interfSmoothed","interfCorrected","dudt_interf","intersectionPoints","applyYAxisTransform","yOffset","yScale","generateChartData","maxPoints","step","T","TZ","IF","IFs","DUDT","TZt","IFt","IFst","DUDTt","intersectionDerivative","chartData","original","label","borderColor","backgroundColor","borderWidth","tension","processed","pointRadius","showLine","pointStyle","rawData","dudt"],"sources":["C:/Users/Иван/Desktop/signal-analyzer1/src/csvProcessor.js"],"sourcesContent":["// ============================================================\n//  CSV обработка\n// ============================================================\n\nexport const processCSVData = (file) => {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onload = (e) => {\n      try {\n        const csvText = e.target.result;\n        const results = parseCSV(csvText);\n        resolve(results);\n      } catch (error) {\n        reject(error);\n      }\n    };\n\n    reader.onerror = () => reject(new Error(\"Ошибка чтения файла\"));\n    reader.readAsText(file);\n  });\n};\n\n\n// ============================================================\n//  МАТРИЧНЫЕ УТИЛИТЫ\n// ============================================================\n\nconst transpose = (M) => M[0].map((_, i) => M.map(row => row[i]));\n\nconst multiplyMatrices = (A, B) => {\n  const aRows = A.length, aCols = A[0].length, bCols = B[0].length;\n  const C = Array.from({ length: aRows }, () => Array(bCols).fill(0));\n  for (let i = 0; i < aRows; i++) {\n    for (let k = 0; k < aCols; k++) {\n      let v = A[i][k];\n      for (let j = 0; j < bCols; j++) C[i][j] += v * B[k][j];\n    }\n  }\n  return C;\n};\n\nconst invertMatrix = (m) => {\n  const n = m.length;\n  const A = m.map((row, i) =>\n    row.concat(Array.from({ length: n }, (_, j) => (i === j ? 1 : 0)))\n  );\n\n  for (let i = 0; i < n; i++) {\n    let maxRow = i;\n    for (let k = i + 1; k < n; k++) {\n      if (Math.abs(A[k][i]) > Math.abs(A[maxRow][i])) maxRow = k;\n    }\n    if (Math.abs(A[maxRow][i]) < 1e-15) throw new Error(\"Матрица вырождена\");\n\n    if (maxRow !== i) [A[i], A[maxRow]] = [A[maxRow], A[i]];\n\n    const diag = A[i][i];\n    for (let j = 0; j < 2 * n; j++) A[i][j] /= diag;\n\n    for (let k = 0; k < n; k++) {\n      if (k === i) continue;\n      let factor = A[k][i];\n      for (let j = 0; j < 2 * n; j++) A[k][j] -= factor * A[i][j];\n    }\n  }\n\n  return A.map(row => row.slice(n));\n};\n\n\n// ============================================================\n//  SAVITZKY–GOLAY\n// ============================================================\n\nconst savitzkyGolay = (data, windowSize = 31, polyOrder = 3) => {\n  if (!Array.isArray(data) || data.length === 0) return [];\n\n  windowSize = Math.max(3, Math.floor(windowSize));\n  if (windowSize % 2 === 0) windowSize += 1;\n\n  polyOrder = Math.max(1, Math.floor(polyOrder));\n  if (polyOrder >= windowSize) polyOrder = windowSize - 1;\n\n  const n = data.length;\n  const half = Math.floor(windowSize / 2);\n\n  const A = [];\n  for (let i = -half; i <= half; i++) {\n    const row = [];\n    for (let p = 0; p <= polyOrder; p++) row.push(i ** p);\n    A.push(row);\n  }\n\n  const AT = transpose(A);\n  const ATA = multiplyMatrices(AT, A);\n  let invATA;\n\n  try {\n    invATA = invertMatrix(ATA);\n  } catch {\n    return data.slice();\n  }\n\n  const coeffs = multiplyMatrices(invATA, AT)[0];\n\n  const out = new Array(n).fill(0);\n  for (let i = 0; i < n; i++) {\n    let sum = 0;\n    for (let j = -half; j <= half; j++) {\n      const idx = Math.min(n - 1, Math.max(0, i + j));\n      sum += data[idx] * coeffs[j + half];\n    }\n    out[i] = sum;\n  }\n  return out;\n};\n\n\n// ============================================================\n//  SG производная\n// ============================================================\n\nconst calculateDerivativeSG = (t, signal, windowSize = 31, polyOrder = 3) => {\n  const n = signal.length;\n\n  if (n < 5) return new Array(n).fill(0);\n\n  const half = Math.floor(windowSize / 2);\n\n  const A = [];\n  for (let i = -half; i <= half; i++) {\n    const row = [];\n    for (let p = 0; p <= polyOrder; p++) row.push(i ** p);\n    A.push(row);\n  }\n\n  const AT = transpose(A);\n  const ATA = multiplyMatrices(AT, A);\n\n  let invATA;\n  try {\n    invATA = invertMatrix(ATA);\n  } catch {\n    return new Array(n).fill(0);\n  }\n\n  const coeffsDeriv = multiplyMatrices(invATA, AT)[1];\n  const dt = t[1] - t[0];\n\n  const out = new Array(n).fill(0);\n\n  for (let i = 0; i < n; i++) {\n    let sum = 0;\n    for (let j = -half; j <= half; j++) {\n      const idx = Math.min(n - 1, Math.max(0, i + j));\n      sum += signal[idx] * coeffsDeriv[j + half];\n    }\n    out[i] = sum / dt;\n  }\n\n  return out;\n};\n\n\n// ============================================================\n//  Базовая коррекция\n// ============================================================\n\nconst removeBaseline = (arr, N = 2000) => {\n  if (!Array.isArray(arr) || arr.length === 0) return [];\n  const c = Math.min(N, arr.length);\n  const avg = arr.slice(0, c).reduce((s, x) => s + x, 0) / c;\n  return arr.map(v => v - avg);\n};\n\n\n// ============================================================\n//  Нулевые пересечения\n// ============================================================\n\nconst findZeroCrossings = (t, y, eps = 1e-6) => {\n  const resT = [];\n  const resY = [];\n\n  for (let i = 1; i < y.length; i++) {\n    const y1 = y[i - 1], y2 = y[i];\n    const t1 = t[i - 1], t2 = t[i];\n\n    if (Math.abs(y1) < eps) {\n      resT.push(t1);\n      resY.push(0);\n      continue;\n    }\n    if (Math.abs(y2) < eps) {\n      resT.push(t2);\n      resY.push(0);\n      continue;\n    }\n\n    if (y1 * y2 < 0) {\n      const x0 = t1 - y1 * (t2 - t1) / (y2 - y1);\n      resT.push(x0);\n      resY.push(0);\n    }\n  }\n\n  return { t0: resT, y0: resY };\n};\n\n\n// ============================================================\n//  Фильтрация близких точек\n// ============================================================\n\nconst filterClosePoints = (t0, y0, minDist) => {\n  if (!t0.length) return { filteredT0: [], filteredY0: [] };\n\n  let nt = [t0[0]];\n  let ny = [y0[0]];\n\n  for (let i = 1; i < t0.length; i++) {\n    if (t0[i] - nt[nt.length - 1] >= minDist) {\n      nt.push(t0[i]);\n      ny.push(y0[i]);\n    }\n  }\n\n  return { filteredT0: nt, filteredY0: ny };\n};\n\n\n// ============================================================\n//  Пересечение сигналов\n// ============================================================\n\nconst findSignalIntersectionsAtZero = (t, tenz, interf, threshold = 0.02) => {\n  const pts = [];\n\n  for (let i = 1; i < t.length; i++) {\n    const d1 = tenz[i - 1] - interf[i - 1];\n    const d2 = tenz[i] - interf[i];\n\n    if ((d1 <= 0 && d2 > 0) || (d1 >= 0 && d2 < 0)) {\n      const ratio = -d1 / (d2 - d1);\n      const x = t[i - 1] + ratio * (t[i] - t[i - 1]);\n      const y = (tenz[i - 1] + ratio * (tenz[i] - tenz[i - 1]) +\n                interf[i - 1] + ratio * (interf[i] - interf[i - 1])) / 2;\n\n      if (Math.abs(y) <= threshold) pts.push({ time: x, value: y });\n    }\n  }\n\n  return pts;\n};\n\n\n// ============================================================\n//  CSV парсинг\n// ============================================================\n\nconst parseCSV = (csvText, options = {}) => {\n  const sgWindow = options.sgWindow || 31;\n  const sgPoly = options.sgPoly || 3;\n  const baselineN = options.baselineN || 2000;\n\n  const skipStart = options.skipStart || 6650;\n  const skipEnd   = options.skipEnd   || 27000;\n\n  const lines = csvText.split(\"\\n\");\n\n  const t = [];\n  const tenz = [];\n  const interf = [];\n\n  let started = false;\n  let counter = 0;\n\n  for (let line of lines) {\n    line = line.trim();\n    if (!line) continue;\n\n    if (line.startsWith(\"TIME,CH1\")) {\n      started = true;\n      continue;\n    }\n    if (!started) continue;\n\n    counter++;\n    if (counter < skipStart) continue;\n    if (counter > skipEnd) break;\n\n    const f = line.split(\",\");\n    if (f.length < 5) continue;\n\n    const timeVal = parseFloat(f[0]);\n    const ch1Val = parseFloat(f[1]);\n    const ch3Val = parseFloat(f[3]);\n\n    if (isNaN(timeVal)) continue;\n\n    t.push(timeVal);\n    tenz.push(ch1Val * 0.00132 * 1.25);\n    interf.push(ch3Val + 0.04);\n  }\n\n  const interfSmoothed = savitzkyGolay(interf, sgWindow, sgPoly);\n  const interfCorrected = removeBaseline(interfSmoothed, baselineN);\n\n  const { t0, y0 } = findZeroCrossings(t, interfCorrected);\n  const { filteredT0, filteredY0 } = filterClosePoints(t0, y0, 100e-9);\n\n  const dudt_interf = calculateDerivativeSG(t, interfCorrected, sgWindow, sgPoly);\n  const intersectionPoints = findSignalIntersectionsAtZero(t, tenz, interfCorrected);\n\n  return {\n    t, tenz, interf,\n    interfSmoothed,\n    interfCorrected,\n    t0: filteredT0,\n    y0: filteredY0,\n    dudt_interf,\n    intersectionPoints\n  };\n};\n\n\n// ============================================================\n//  ФУНКЦИЯ ТРАНСФОРМАЦИИ ДАННЫХ ПО OY\n// ============================================================\n\nconst applyYAxisTransform = (arr, yOffset, yScale) => {\n  return arr.map(v => v * yScale + yOffset);\n};\n\n\n// ============================================================\n//  ПОДГОТОВКА ДАННЫХ ДЛЯ ГРАФИКОВ\n// ============================================================\n\nexport const generateChartData = (results, options = {}) => {\n  const {\n    t, tenz, interfSmoothed, interfCorrected, dudt_interf, intersectionPoints\n  } = results;\n\n  const maxPoints = options.maxPoints || 2000;\n  const step = Math.max(1, Math.floor(t.length / maxPoints));\n\n  const yOffset = options.yOffset || 0;\n  const yScale = options.yScale || 1;\n\n  const T = [];\n  const TZ = [];\n  const IF = [];\n  const IFs = [];\n  const DUDT = [];\n\n  for (let i = 0; i < t.length; i += step) {\n    T.push(t[i]);\n    TZ.push(tenz[i]);\n    IF.push(interfCorrected[i]);\n    IFs.push(interfSmoothed[i]);\n    DUDT.push(dudt_interf[i]);\n  }\n\n  // применяем масштабирование и смещение\n  const TZt    = applyYAxisTransform(TZ, yOffset, yScale);\n  const IFt    = applyYAxisTransform(IF, yOffset, yScale);\n  const IFst   = applyYAxisTransform(IFs, yOffset, yScale);\n  const DUDTt  = applyYAxisTransform(DUDT, yOffset, yScale);\n\n  const intersectionDerivative = (intersectionPoints || []).map(({ time }) => ({\n    x: time,\n    y: applyYAxisTransform(\n      [dudt_interf[Math.floor(dudt_interf.length / 2)]],\n      yOffset,\n      yScale\n    )[0]\n  }));\n\n  const chartData = {\n    original: [\n      {\n        label: \"Тензометрический сигнал\",\n        data: T.map((time, i) => ({ x: time, y: TZt[i] })),\n        borderColor: \"rgb(255,99,132)\",\n        backgroundColor: \"rgba(255,99,132,0.1)\",\n        borderWidth: 1,\n        tension: 0.1\n      },\n      {\n        label: \"Интерферометрический сигнал (сглаженный)\",\n        data: T.map((time, i) => ({ x: time, y: IFst[i] })),\n        borderColor: \"black\",\n        backgroundColor: \"rgba(0,0,0,0.05)\",\n        borderWidth: 1,\n        tension: 0.1\n      },\n      {\n        label: \"Интерферометрический (центрированный)\",\n        data: T.map((time, i) => ({ x: time, y: IFt[i] })),\n        borderColor: \"rgb(54,162,235)\",\n        backgroundColor: \"rgba(54,162,235,0.1)\",\n        borderWidth: 1,\n        tension: 0.1\n      }\n    ],\n\n    processed: [\n      {\n        label: \"Производная интерферометра\",\n        data: T.map((time, i) => ({ x: time, y: DUDTt[i] })),\n        borderColor: \"rgb(75,192,192)\",\n        backgroundColor: \"rgba(75,192,192,0.1)\",\n        borderWidth: 2,\n        pointRadius: 0,\n        showLine: true\n      },\n      {\n        label: \"Скорректированный тензосигнал\",\n        data: T.map((time, i) => ({ x: time, y: TZt[i] })),\n        borderColor: \"rgb(153,102,255)\",\n        backgroundColor: \"rgba(153,102,255,0.1)\",\n        borderWidth: 1,\n        tension: 0.1\n      },\n      {\n        label: \"Пересечения\",\n        data: intersectionDerivative,\n        pointStyle: \"crossRot\",\n        pointRadius: 4,\n        borderColor: \"rgb(75,192,192)\",\n        showLine: false\n      }\n    ],\n\n    rawData: {\n      t: T,\n      tenz: TZt,\n      interf: IFt,\n      dudt: DUDTt\n    }\n  };\n\n  return chartData;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}