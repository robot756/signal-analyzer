{"ast":null,"code":"// -------------------- CSV обработка --------------------\nexport const processCSVData = (file, options = {}) => {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = e => {\n      try {\n        const csvText = e.target.result;\n        const results = parseCSV(csvText, options);\n        resolve(results);\n      } catch (error) {\n        reject(error);\n      }\n    };\n    reader.onerror = () => reject(new Error(\"Ошибка чтения файла\"));\n    reader.readAsText(file);\n  });\n};\n\n// -------------------- Утилиты для матриц --------------------\nconst transpose = M => M[0].map((_, i) => M.map(row => row[i]));\nconst multiplyMatrices = (A, B) => {\n  const aRows = A.length,\n    aCols = A[0].length,\n    bCols = B[0].length;\n  const C = Array.from({\n    length: aRows\n  }, () => Array(bCols).fill(0));\n  for (let i = 0; i < aRows; i++) {\n    for (let k = 0; k < aCols; k++) {\n      const v = A[i][k];\n      for (let j = 0; j < bCols; j++) {\n        C[i][j] += v * B[k][j];\n      }\n    }\n  }\n  return C;\n};\nconst invertMatrix = m => {\n  const n = m.length;\n  const A = m.map((row, i) => row.concat(Array.from({\n    length: n\n  }, (_, j) => i === j ? 1 : 0)));\n  for (let i = 0; i < n; i++) {\n    let maxRow = i;\n    for (let k = i + 1; k < n; k++) if (Math.abs(A[k][i]) > Math.abs(A[maxRow][i])) maxRow = k;\n    if (Math.abs(A[maxRow][i]) < 1e-15) throw new Error(\"Matrix degenerate\");\n    if (maxRow !== i) [A[i], A[maxRow]] = [A[maxRow], A[i]];\n    const diag = A[i][i];\n    for (let j = 0; j < 2 * n; j++) A[i][j] /= diag;\n    for (let k = 0; k < n; k++) {\n      if (k === i) continue;\n      const factor = A[k][i];\n      for (let j = 0; j < 2 * n; j++) A[k][j] -= factor * A[i][j];\n    }\n  }\n  return A.map(row => row.slice(n));\n};\n\n// -------------------- Savitzky–Golay фильтр --------------------\nconst savitzkyGolay = (data, windowSize = 31, polyOrder = 3) => {\n  if (!Array.isArray(data) || data.length === 0) return [];\n  windowSize = Math.max(3, Math.floor(windowSize));\n  if (windowSize % 2 === 0) windowSize += 1;\n  polyOrder = Math.max(1, Math.floor(polyOrder));\n  if (polyOrder >= windowSize) polyOrder = windowSize - 1;\n  const n = data.length;\n  const half = Math.floor(windowSize / 2);\n  const A = [];\n  for (let i = -half; i <= half; i++) {\n    const row = [];\n    for (let p = 0; p <= polyOrder; p++) row.push(i ** p);\n    A.push(row);\n  }\n  const AT = transpose(A);\n  const ATA = multiplyMatrices(AT, A);\n  let invATA;\n  try {\n    invATA = invertMatrix(ATA);\n  } catch {\n    return data.slice();\n  }\n  const ATAinvAT = multiplyMatrices(invATA, AT);\n  const coeffs = ATAinvAT[0];\n  const out = new Array(n).fill(0);\n  for (let i = 0; i < n; i++) {\n    let acc = 0;\n    for (let j = -half; j <= half; j++) {\n      let idx = i + j;\n      if (idx < 0) idx = 0;\n      if (idx >= n) idx = n - 1;\n      acc += data[idx] * coeffs[j + half];\n    }\n    out[i] = acc;\n  }\n  return out;\n};\n\n// -------------------- SG производная --------------------\nconst calculateDerivativeSG = (t, signal, windowSize = 31, polyOrder = 3) => {\n  const n = signal.length;\n  if (n < 3) return new Array(n).fill(0);\n  const half = Math.floor(windowSize / 2);\n  const A = [];\n  for (let i = -half; i <= half; i++) {\n    const row = [];\n    for (let p = 0; p <= polyOrder; p++) row.push(i ** p);\n    A.push(row);\n  }\n  const AT = transpose(A);\n  const ATA = multiplyMatrices(AT, A);\n  let invATA;\n  try {\n    invATA = invertMatrix(ATA);\n  } catch {\n    return new Array(n).fill(0);\n  }\n  const ATAinvAT = multiplyMatrices(invATA, AT);\n  const coeffsDeriv = ATAinvAT[1];\n  const dtConst = t[1] - t[0];\n  const derivative = new Array(n).fill(0);\n  for (let i = 0; i < n; i++) {\n    let acc = 0;\n    for (let j = -half; j <= half; j++) {\n      let idx = i + j;\n      if (idx < 0) idx = 0;\n      if (idx >= n) idx = n - 1;\n      acc += signal[idx] * coeffsDeriv[j + half];\n    }\n    derivative[i] = acc / dtConst;\n  }\n  return derivative;\n};\n\n// -------------------- Baseline removal --------------------\nconst removeBaseline = (arr, N = 2000) => {\n  const count = Math.min(arr.length, N);\n  const avg = arr.slice(0, count).reduce((s, v) => s + v, 0) / count;\n  return arr.map(v => v - avg);\n};\n\n// -------------------- CSV парсинг --------------------\nconst parseCSV = (csvText, options = {}) => {\n  const sgWindow = options.sgWindow || 31;\n  const sgPoly = options.sgPoly || 3;\n  const baselineN = options.baselineN || 2000;\n  const skipStart = options.skipStart || 6650;\n  const skipEnd = options.skipEnd || 27000;\n  const derivativeWindowNs = options.derivativeWindowNs || 200; // <<< CHANGES\n\n  const lines = csvText.split(\"\\n\");\n  const t = [],\n    tenz = [],\n    interf = [];\n  let dataStarted = false;\n  let lineCount = 0;\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i].trim();\n    if (!line) continue;\n    if (line.startsWith(\"TIME,CH1,\")) {\n      dataStarted = true;\n      continue;\n    }\n    if (!dataStarted) continue;\n    lineCount++;\n    if (lineCount < skipStart) continue;\n    if (lineCount > skipEnd) break;\n    const fields = line.split(\",\");\n    if (fields.length >= 5) {\n      const t0 = parseFloat(fields[0]);\n      const ch1 = parseFloat(fields[1]);\n      const ch3 = parseFloat(fields[3]);\n      if (!isNaN(t0) && !isNaN(ch1) && !isNaN(ch3)) {\n        t.push(t0);\n        tenz.push(ch1 * 0.00132 * 1.25);\n        interf.push(ch3 + 0.04);\n      }\n    }\n  }\n  const interfSmoothed = savitzkyGolay(interf, sgWindow, sgPoly);\n  const interfCorrected = removeBaseline(interfSmoothed, baselineN);\n  const {\n    t0,\n    y0\n  } = findZeroCrossings(t, interfCorrected);\n  const {\n    filteredT0,\n    filteredY0\n  } = filterClosePoints(t0, y0, 100e-9);\n\n  // -------------------- CHANGES: локальная производная --------------------\n  const mask = new Array(t.length).fill(false);\n  const derivWindowSec = derivativeWindowNs * 1e-9;\n  for (let k = 0; k < filteredT0.length; k++) {\n    const center = filteredT0[k];\n    const tMin = center - derivWindowSec;\n    const tMax = center + derivWindowSec;\n    for (let i = 0; i < t.length; i++) {\n      if (t[i] >= tMin && t[i] <= tMax) mask[i] = true;\n    }\n  }\n  const tForDeriv = [];\n  const interfForDeriv = [];\n  const idxMap = [];\n  for (let i = 0; i < t.length; i++) {\n    if (mask[i]) {\n      tForDeriv.push(t[i]);\n      interfForDeriv.push(interfCorrected[i]);\n      idxMap.push(i);\n    }\n  }\n  const dudt_local = tForDeriv.length > 3 ? calculateDerivativeSG(tForDeriv, interfForDeriv, sgWindow, sgPoly) : [];\n  const dudt_interf = new Array(t.length).fill(0);\n  for (let k = 0; k < idxMap.length; k++) {\n    dudt_interf[idxMap[k]] = dudt_local[k];\n  }\n\n  // -------------------- пересечения тензо и центрированного интерф --------------------\n  const intersectionPoints = findSignalIntersectionsAtZero(t, tenz, interfCorrected);\n  return {\n    t,\n    tenz,\n    interf,\n    interfSmoothed,\n    interfCorrected,\n    t0: filteredT0,\n    y0: filteredY0,\n    dudt_interf,\n    intersectionPoints\n  };\n};\n\n// -------------------- Нулевые пересечения --------------------\nconst findZeroCrossings = (t, interf, eps = 1e-6) => {\n  const t0 = [];\n  const y0 = [];\n  for (let i = 1; i < interf.length; i++) {\n    const y1 = interf[i - 1],\n      y2 = interf[i];\n    if (y1 * y2 < 0) {\n      const x1 = t[i - 1],\n        x2 = t[i];\n      const tZ = x1 - y1 * (x2 - x1) / (y2 - y1);\n      t0.push(tZ);\n      y0.push(0);\n    }\n  }\n  return {\n    t0,\n    y0\n  };\n};\n\n// -------------------- Фильтрация близких точек --------------------\nconst filterClosePoints = (t0, y0, minDistance) => {\n  if (!t0 || t0.length <= 1) return {\n    filteredT0: t0 || [],\n    filteredY0: y0 || []\n  };\n  let outT = [...t0];\n  let outY = [...y0];\n  for (let k = 0; k < 10; k++) {\n    const newT = [outT[0]];\n    const newY = [outY[0]];\n    for (let i = 1; i < outT.length; i++) {\n      if (outT[i] - newT[newT.length - 1] >= minDistance) {\n        newT.push(outT[i]);\n        newY.push(outY[i]);\n      }\n    }\n    if (newT.length === outT.length) break;\n    outT = newT;\n    outY = newY;\n  }\n  return {\n    filteredT0: outT,\n    filteredY0: outY\n  };\n};\n\n// -------------------- Пересечения сигналов --------------------\nconst findSignalIntersectionsAtZero = (t, tenz, interf, yThreshold = 0.02) => {\n  const intersections = [];\n  for (let i = 1; i < t.length; i++) {\n    const diffPrev = tenz[i - 1] - interf[i - 1];\n    const diffCurr = tenz[i] - interf[i];\n    if (diffPrev <= 0 && diffCurr > 0 || diffPrev >= 0 && diffCurr < 0) {\n      const t1 = t[i - 1],\n        t2 = t[i];\n      const ratio = -diffPrev / (diffCurr - diffPrev);\n      const time = t1 + ratio * (t2 - t1);\n      const value = (tenz[i - 1] + ratio * (tenz[i] - tenz[i - 1]) + interf[i - 1] + ratio * (interf[i] - interf[i - 1])) / 2;\n      if (Math.abs(value) <= yThreshold) intersections.push({\n        time,\n        value\n      });\n    }\n  }\n  return intersections;\n};\n\n// -------------------- Подготовка данных для графиков --------------------\nexport const generateChartData = (results, options = {}) => {\n  const {\n    t,\n    tenz,\n    interfCorrected,\n    interfSmoothed,\n    dudt_interf,\n    intersectionPoints\n  } = results;\n  const maxPoints = options.maxPoints || 2000;\n  const step = Math.max(1, Math.floor(t.length / maxPoints));\n  const lt = [],\n    lten = [],\n    lint = [],\n    lsm = [],\n    lder = [];\n  for (let i = 0; i < t.length; i += step) {\n    lt.push(t[i]);\n    lten.push(tenz[i]);\n    lint.push(interfCorrected[i]);\n    lsm.push(interfSmoothed[i]);\n    lder.push(dudt_interf[i]);\n  }\n  const chartData = {\n    original: [{\n      label: \"Тензометрический сигнал (CH1)\",\n      data: lt.map((x, i) => ({\n        x,\n        y: lten[i]\n      })),\n      borderColor: \"rgb(255,99,132)\",\n      borderWidth: 1,\n      pointRadius: 0,\n      showLine: true\n    }, {\n      label: \"Интерф CH3 (SG)\",\n      data: lt.map((x, i) => ({\n        x,\n        y: lsm[i]\n      })),\n      borderColor: \"rgb(0,0,0)\",\n      borderWidth: 1\n    }, {\n      label: \"Интерф центрированный\",\n      data: lt.map((x, i) => ({\n        x,\n        y: lint[i]\n      })),\n      borderColor: \"rgb(54,162,235)\",\n      borderWidth: 1\n    }, {\n      label: \"Пересечения тензо и интерф\",\n      data: intersectionPoints.map(p => ({\n        x: p.time,\n        y: p.value\n      })),\n      pointStyle: \"circle\",\n      pointRadius: 6,\n      pointHoverRadius: 8,\n      showLine: false,\n      borderColor: \"rgb(255, 165, 0)\",\n      backgroundColor: \"rgba(255, 165, 0, 0.6)\",\n      borderWidth: 2\n    }],\n    processed: [{\n      label: \"Производная (локальная)\",\n      data: lt.map((x, i) => ({\n        x,\n        y: lder[i]\n      })),\n      borderColor: \"rgb(75,192,192)\",\n      borderWidth: 2,\n      pointRadius: 0,\n      showLine: true\n    }, {\n      label: \"Пересечения тензо и интерф\",\n      data: intersectionPoints.map(p => ({\n        x: p.time,\n        y: p.value\n      })),\n      pointStyle: \"circle\",\n      pointRadius: 6,\n      pointHoverRadius: 8,\n      showLine: false,\n      borderColor: \"rgb(255, 0, 0)\",\n      backgroundColor: \"rgba(255, 0, 0, 0.6)\",\n      borderWidth: 2\n    }],\n    rawData: {\n      t,\n      tenz,\n      interf: results.interf,\n      interfCorrected\n    }\n  };\n  chartData.intersections = intersectionPoints || [];\n  return chartData;\n};","map":{"version":3,"names":["processCSVData","file","options","Promise","resolve","reject","reader","FileReader","onload","e","csvText","target","result","results","parseCSV","error","onerror","Error","readAsText","transpose","M","map","_","i","row","multiplyMatrices","A","B","aRows","length","aCols","bCols","C","Array","from","fill","k","v","j","invertMatrix","m","n","concat","maxRow","Math","abs","diag","factor","slice","savitzkyGolay","data","windowSize","polyOrder","isArray","max","floor","half","p","push","AT","ATA","invATA","ATAinvAT","coeffs","out","acc","idx","calculateDerivativeSG","t","signal","coeffsDeriv","dtConst","derivative","removeBaseline","arr","N","count","min","avg","reduce","s","sgWindow","sgPoly","baselineN","skipStart","skipEnd","derivativeWindowNs","lines","split","tenz","interf","dataStarted","lineCount","line","trim","startsWith","fields","t0","parseFloat","ch1","ch3","isNaN","interfSmoothed","interfCorrected","y0","findZeroCrossings","filteredT0","filteredY0","filterClosePoints","mask","derivWindowSec","center","tMin","tMax","tForDeriv","interfForDeriv","idxMap","dudt_local","dudt_interf","intersectionPoints","findSignalIntersectionsAtZero","eps","y1","y2","x1","x2","tZ","minDistance","outT","outY","newT","newY","yThreshold","intersections","diffPrev","diffCurr","t1","t2","ratio","time","value","generateChartData","maxPoints","step","lt","lten","lint","lsm","lder","chartData","original","label","x","y","borderColor","borderWidth","pointRadius","showLine","pointStyle","pointHoverRadius","backgroundColor","processed","rawData"],"sources":["C:/Users/Иван/Desktop/signal-analyzer1/src/csvProcessor.js"],"sourcesContent":["// -------------------- CSV обработка --------------------\nexport const processCSVData = (file, options = {}) => {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onload = (e) => {\n      try {\n        const csvText = e.target.result;\n        const results = parseCSV(csvText, options);\n        resolve(results);\n      } catch (error) {\n        reject(error);\n      }\n    };\n\n    reader.onerror = () => reject(new Error(\"Ошибка чтения файла\"));\n    reader.readAsText(file);\n  });\n};\n\n// -------------------- Утилиты для матриц --------------------\nconst transpose = (M) => M[0].map((_, i) => M.map(row => row[i]));\n\nconst multiplyMatrices = (A, B) => {\n  const aRows = A.length, aCols = A[0].length, bCols = B[0].length;\n  const C = Array.from({ length: aRows }, () => Array(bCols).fill(0));\n  for (let i = 0; i < aRows; i++) {\n    for (let k = 0; k < aCols; k++) {\n      const v = A[i][k];\n      for (let j = 0; j < bCols; j++) {\n        C[i][j] += v * B[k][j];\n      }\n    }\n  }\n  return C;\n};\n\nconst invertMatrix = (m) => {\n  const n = m.length;\n  const A = m.map((row, i) => row.concat(Array.from({ length: n }, (_, j) => (i === j ? 1 : 0))));\n  for (let i = 0; i < n; i++) {\n    let maxRow = i;\n    for (let k = i + 1; k < n; k++) if (Math.abs(A[k][i]) > Math.abs(A[maxRow][i])) maxRow = k;\n    if (Math.abs(A[maxRow][i]) < 1e-15) throw new Error(\"Matrix degenerate\");\n    if (maxRow !== i) [A[i], A[maxRow]] = [A[maxRow], A[i]];\n    const diag = A[i][i];\n    for (let j = 0; j < 2 * n; j++) A[i][j] /= diag;\n    for (let k = 0; k < n; k++) {\n      if (k === i) continue;\n      const factor = A[k][i];\n      for (let j = 0; j < 2 * n; j++) A[k][j] -= factor * A[i][j];\n    }\n  }\n  return A.map(row => row.slice(n));\n};\n\n// -------------------- Savitzky–Golay фильтр --------------------\nconst savitzkyGolay = (data, windowSize = 31, polyOrder = 3) => {\n  if (!Array.isArray(data) || data.length === 0) return [];\n  windowSize = Math.max(3, Math.floor(windowSize));\n  if (windowSize % 2 === 0) windowSize += 1;\n  polyOrder = Math.max(1, Math.floor(polyOrder));\n  if (polyOrder >= windowSize) polyOrder = windowSize - 1;\n\n  const n = data.length;\n  const half = Math.floor(windowSize / 2);\n\n  const A = [];\n  for (let i = -half; i <= half; i++) {\n    const row = [];\n    for (let p = 0; p <= polyOrder; p++) row.push(i ** p);\n    A.push(row);\n  }\n\n  const AT = transpose(A);\n  const ATA = multiplyMatrices(AT, A);\n  let invATA;\n  try { invATA = invertMatrix(ATA); } catch { return data.slice(); }\n  const ATAinvAT = multiplyMatrices(invATA, AT);\n  const coeffs = ATAinvAT[0];\n\n  const out = new Array(n).fill(0);\n  for (let i = 0; i < n; i++) {\n    let acc = 0;\n    for (let j = -half; j <= half; j++) {\n      let idx = i + j;\n      if (idx < 0) idx = 0;\n      if (idx >= n) idx = n - 1;\n      acc += data[idx] * coeffs[j + half];\n    }\n    out[i] = acc;\n  }\n  return out;\n};\n\n// -------------------- SG производная --------------------\nconst calculateDerivativeSG = (t, signal, windowSize = 31, polyOrder = 3) => {\n  const n = signal.length;\n  if (n < 3) return new Array(n).fill(0);\n\n  const half = Math.floor(windowSize / 2);\n  const A = [];\n  for (let i = -half; i <= half; i++) {\n    const row = [];\n    for (let p = 0; p <= polyOrder; p++) row.push(i ** p);\n    A.push(row);\n  }\n  const AT = transpose(A);\n  const ATA = multiplyMatrices(AT, A);\n  let invATA;\n  try { invATA = invertMatrix(ATA); } catch { return new Array(n).fill(0); }\n  const ATAinvAT = multiplyMatrices(invATA, AT);\n  const coeffsDeriv = ATAinvAT[1];\n\n  const dtConst = t[1] - t[0];  \n  const derivative = new Array(n).fill(0);\n\n  for (let i = 0; i < n; i++) {\n    let acc = 0;\n    for (let j = -half; j <= half; j++) {\n      let idx = i + j;\n      if (idx < 0) idx = 0;\n      if (idx >= n) idx = n - 1;\n      acc += signal[idx] * coeffsDeriv[j + half];\n    }\n    derivative[i] = acc / dtConst;\n  }\n  return derivative;\n};\n\n// -------------------- Baseline removal --------------------\nconst removeBaseline = (arr, N = 2000) => {\n  const count = Math.min(arr.length, N);\n  const avg = arr.slice(0, count).reduce((s, v) => s + v, 0) / count;\n  return arr.map(v => v - avg);\n};\n\n// -------------------- CSV парсинг --------------------\nconst parseCSV = (csvText, options = {}) => {\n\n  const sgWindow = options.sgWindow || 31;\n  const sgPoly = options.sgPoly || 3;\n  const baselineN = options.baselineN || 2000;\n  const skipStart = options.skipStart || 6650;\n  const skipEnd = options.skipEnd || 27000;\n  const derivativeWindowNs = options.derivativeWindowNs || 200; // <<< CHANGES\n\n  const lines = csvText.split(\"\\n\");\n  const t = [], tenz = [], interf = [];\n\n  let dataStarted = false;\n  let lineCount = 0;\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i].trim();\n    if (!line) continue;\n    if (line.startsWith(\"TIME,CH1,\")) {\n      dataStarted = true;\n      continue;\n    }\n    if (!dataStarted) continue;\n\n    lineCount++;\n    if (lineCount < skipStart) continue;\n    if (lineCount > skipEnd) break;\n\n    const fields = line.split(\",\");\n    if (fields.length >= 5) {\n      const t0 = parseFloat(fields[0]);\n      const ch1 = parseFloat(fields[1]);\n      const ch3 = parseFloat(fields[3]);\n      if (!isNaN(t0) && !isNaN(ch1) && !isNaN(ch3)) {\n        t.push(t0);\n        tenz.push(ch1 * 0.00132 * 1.25);\n        interf.push(ch3 + 0.04);\n      }\n    }\n  }\n\n  const interfSmoothed = savitzkyGolay(interf, sgWindow, sgPoly);\n  const interfCorrected = removeBaseline(interfSmoothed, baselineN);\n\n  const { t0, y0 } = findZeroCrossings(t, interfCorrected);\n  const { filteredT0, filteredY0 } = filterClosePoints(t0, y0, 100e-9);\n\n  // -------------------- CHANGES: локальная производная --------------------\n  const mask = new Array(t.length).fill(false);\n  const derivWindowSec = derivativeWindowNs * 1e-9;\n  for (let k = 0; k < filteredT0.length; k++) {\n    const center = filteredT0[k];\n    const tMin = center - derivWindowSec;\n    const tMax = center + derivWindowSec;\n    for (let i = 0; i < t.length; i++) {\n      if (t[i] >= tMin && t[i] <= tMax) mask[i] = true;\n    }\n  }\n\n  const tForDeriv = [];\n  const interfForDeriv = [];\n  const idxMap = [];\n  for (let i = 0; i < t.length; i++) {\n    if (mask[i]) {\n      tForDeriv.push(t[i]);\n      interfForDeriv.push(interfCorrected[i]);\n      idxMap.push(i);\n    }\n  }\n\n  const dudt_local = tForDeriv.length > 3\n    ? calculateDerivativeSG(tForDeriv, interfForDeriv, sgWindow, sgPoly)\n    : [];\n\n  const dudt_interf = new Array(t.length).fill(0);\n  for (let k = 0; k < idxMap.length; k++) {\n    dudt_interf[idxMap[k]] = dudt_local[k];\n  }\n\n  // -------------------- пересечения тензо и центрированного интерф --------------------\n  const intersectionPoints = findSignalIntersectionsAtZero(t, tenz, interfCorrected);\n\n  return {\n    t,\n    tenz,\n    interf,\n    interfSmoothed,\n    interfCorrected,\n    t0: filteredT0,\n    y0: filteredY0,\n    dudt_interf,\n    intersectionPoints,\n  };\n};\n\n// -------------------- Нулевые пересечения --------------------\nconst findZeroCrossings = (t, interf, eps = 1e-6) => {\n  const t0 = [];\n  const y0 = [];\n  for (let i = 1; i < interf.length; i++) {\n    const y1 = interf[i - 1], y2 = interf[i];\n    if (y1 * y2 < 0) {\n      const x1 = t[i - 1], x2 = t[i];\n      const tZ = x1 - y1 * (x2 - x1) / (y2 - y1);\n      t0.push(tZ);\n      y0.push(0);\n    }\n  }\n  return { t0, y0 };\n};\n\n// -------------------- Фильтрация близких точек --------------------\nconst filterClosePoints = (t0, y0, minDistance) => {\n  if (!t0 || t0.length <= 1) return { filteredT0: t0 || [], filteredY0: y0 || [] };\n\n  let outT = [...t0];\n  let outY = [...y0];\n\n  for (let k = 0; k < 10; k++) {\n    const newT = [outT[0]];\n    const newY = [outY[0]];\n    for (let i = 1; i < outT.length; i++) {\n      if (outT[i] - newT[newT.length - 1] >= minDistance) {\n        newT.push(outT[i]);\n        newY.push(outY[i]);\n      }\n    }\n    if (newT.length === outT.length) break;\n    outT = newT;\n    outY = newY;\n  }\n  return { filteredT0: outT, filteredY0: outY };\n};\n\n// -------------------- Пересечения сигналов --------------------\nconst findSignalIntersectionsAtZero = (t, tenz, interf, yThreshold = 0.02) => {\n  const intersections = [];\n  for (let i = 1; i < t.length; i++) {\n    const diffPrev = tenz[i - 1] - interf[i - 1];\n    const diffCurr = tenz[i] - interf[i];\n    if ((diffPrev <= 0 && diffCurr > 0) || (diffPrev >= 0 && diffCurr < 0)) {\n      const t1 = t[i - 1], t2 = t[i];\n      const ratio = -diffPrev / (diffCurr - diffPrev);\n      const time = t1 + ratio * (t2 - t1);\n      const value = (tenz[i - 1] + ratio * (tenz[i] - tenz[i - 1])\n                     + interf[i - 1] + ratio * (interf[i] - interf[i - 1])) / 2;\n      if (Math.abs(value) <= yThreshold) intersections.push({ time, value });\n    }\n  }\n  return intersections;\n};\n\n// -------------------- Подготовка данных для графиков --------------------\nexport const generateChartData = (results, options = {}) => {\n  const {\n    t,\n    tenz,\n    interfCorrected,\n    interfSmoothed,\n    dudt_interf,\n    intersectionPoints\n  } = results;\n\n  const maxPoints = options.maxPoints || 2000;\n  const step = Math.max(1, Math.floor(t.length / maxPoints));\n\n  const lt = [], lten = [], lint = [], lsm = [], lder = [];\n  for (let i = 0; i < t.length; i += step) {\n    lt.push(t[i]);\n    lten.push(tenz[i]);\n    lint.push(interfCorrected[i]);\n    lsm.push(interfSmoothed[i]);\n    lder.push(dudt_interf[i]);\n  }\n\n  const chartData = {\n    original: [\n      { label: \"Тензометрический сигнал (CH1)\", data: lt.map((x,i)=>({x,y:lten[i]})), borderColor:\"rgb(255,99,132)\", borderWidth:1, pointRadius: 0, showLine: true },\n      { label: \"Интерф CH3 (SG)\", data: lt.map((x,i)=>({x,y:lsm[i]})), borderColor:\"rgb(0,0,0)\", borderWidth:1 },\n      { label: \"Интерф центрированный\", data: lt.map((x,i)=>({x,y:lint[i]})), borderColor:\"rgb(54,162,235)\", borderWidth:1 },\n      { \n        label: \"Пересечения тензо и интерф\", \n        data: intersectionPoints.map(p=>({x:p.time,y:p.value})), \n        pointStyle: \"circle\",\n        pointRadius: 6,\n        pointHoverRadius: 8,\n        showLine: false, \n        borderColor: \"rgb(255, 165, 0)\",\n        backgroundColor: \"rgba(255, 165, 0, 0.6)\",\n        borderWidth: 2\n      }\n    ],\n    processed: [\n      { label: \"Производная (локальная)\", data: lt.map((x,i)=>({x,y:lder[i]})), borderColor:\"rgb(75,192,192)\", borderWidth:2, pointRadius:0, showLine:true },\n      { \n        label: \"Пересечения тензо и интерф\", \n        data: intersectionPoints.map(p=>({x:p.time,y:p.value})), \n        pointStyle: \"circle\",\n        pointRadius: 6,\n        pointHoverRadius: 8,\n        showLine: false, \n        borderColor: \"rgb(255, 0, 0)\",\n        backgroundColor: \"rgba(255, 0, 0, 0.6)\",\n        borderWidth: 2\n      }\n    ],\n    rawData: {\n      t,\n      tenz,\n      interf: results.interf,\n      interfCorrected\n    }\n  };\n\n  chartData.intersections = intersectionPoints || [];\n\n  return chartData;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}