{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u0418\\u0432\\u0430\\u043D\\\\Desktop\\\\signal-analyzer1\\\\src\\\\ChartComponent.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useCallback, useState, useMemo } from \"react\";\nimport { Chart, registerables } from \"chart.js\";\nimport zoomPlugin from \"chartjs-plugin-zoom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst intersectionMarkerPlugin = {\n  id: \"intersectionMarker\",\n  afterDatasetsDraw(chart) {\n    const {\n      ctx\n    } = chart;\n    chart.data.datasets.forEach((dataset, datasetIndex) => {\n      if (!(dataset !== null && dataset !== void 0 && dataset.intersectionMarker)) return;\n      const meta = chart.getDatasetMeta(datasetIndex);\n      if (!chart.isDatasetVisible(datasetIndex)) return;\n      meta.data.forEach(element => {\n        var _dataset$markerSize, _dataset$markerColor, _dataset$markerAlpha, _dataset$markerLineWi;\n        // Используем точные координаты элемента после всех трансформаций\n        const x = element.x;\n        const y = element.y;\n\n        // Проверяем, что элемент видим на canvas\n        if (x === undefined || y === undefined || isNaN(x) || isNaN(y)) return;\n        const size = (_dataset$markerSize = dataset.markerSize) !== null && _dataset$markerSize !== void 0 ? _dataset$markerSize : 6;\n        ctx.save();\n        ctx.strokeStyle = (_dataset$markerColor = dataset.markerColor) !== null && _dataset$markerColor !== void 0 ? _dataset$markerColor : \"#000000\";\n        ctx.globalAlpha = (_dataset$markerAlpha = dataset.markerAlpha) !== null && _dataset$markerAlpha !== void 0 ? _dataset$markerAlpha : 0.8;\n        ctx.lineWidth = (_dataset$markerLineWi = dataset.markerLineWidth) !== null && _dataset$markerLineWi !== void 0 ? _dataset$markerLineWi : 2;\n        ctx.lineCap = \"round\";\n        ctx.beginPath();\n        ctx.moveTo(x - size, y - size);\n        ctx.lineTo(x + size, y + size);\n        ctx.moveTo(x - size, y + size);\n        ctx.lineTo(x + size, y - size);\n        ctx.stroke();\n        ctx.restore();\n      });\n    });\n  }\n};\nChart.register(...registerables, zoomPlugin, intersectionMarkerPlugin);\nconst ZOOM_STEP = 1.25;\nconst ChartComponent = ({\n  data\n}) => {\n  _s();\n  var _data$intersections;\n  const originalChartRef = useRef(null);\n  const processedChartRef = useRef(null);\n  const originalChartInstance = useRef(null);\n  const processedChartInstance = useRef(null);\n  const intersections = (_data$intersections = data === null || data === void 0 ? void 0 : data.intersections) !== null && _data$intersections !== void 0 ? _data$intersections : [];\n  const [originalAxisVisibility, setOriginalAxisVisibility] = useState({});\n  const [processedAxisVisibility, setProcessedAxisVisibility] = useState({});\n  const [intersectionVisibility, setIntersectionVisibility] = useState(true);\n  const [tenzOffset, setTenzOffset] = useState(0); // Сдвиг тензосигнала по Y\n  const [currentIntersections, setCurrentIntersections] = useState([]); // Текущие пересечения\n\n  const formatTime = value => {\n    if (typeof value !== \"number\") return \"-\";\n    return value.toExponential(3);\n  };\n  const formatSignal = value => {\n    if (typeof value !== \"number\") return \"-\";\n    return value.toFixed(5);\n  };\n  useEffect(() => {\n    if (!data) return;\n    const buildOptions = (title, yLabel) => ({\n      responsive: true,\n      interaction: {\n        mode: \"index\",\n        intersect: false\n      },\n      scales: {\n        x: {\n          type: \"linear\",\n          title: {\n            display: true,\n            text: \"Время (секунды)\"\n          }\n        },\n        y: {\n          type: \"linear\",\n          title: {\n            display: true,\n            text: yLabel\n          }\n        }\n      },\n      plugins: {\n        title: {\n          display: true,\n          text: title\n        },\n        legend: {\n          display: true\n        },\n        tooltip: {\n          enabled: true,\n          callbacks: {\n            label: function (context) {\n              const point = context.raw;\n              const xValue = typeof point.x === 'number' ? point.x.toExponential(4) : point.x;\n              const yValue = typeof point.y === 'number' ? point.y.toFixed(6) : point.y;\n              return [`${context.dataset.label || ''}`, `X: ${xValue} с`, `Y: ${yValue}`];\n            }\n          }\n        },\n        zoom: {\n          pan: {\n            enabled: true,\n            mode: \"xy\"\n          },\n          zoom: {\n            wheel: {\n              enabled: true,\n              modifierKey: \"ctrl\"\n            },\n            pinch: {\n              enabled: true\n            },\n            drag: {\n              enabled: false\n            },\n            mode: \"xy\"\n          }\n        }\n      }\n    });\n    if (originalChartInstance.current) {\n      originalChartInstance.current.destroy();\n      originalChartInstance.current = null;\n    }\n    if (processedChartInstance.current) {\n      processedChartInstance.current.destroy();\n      processedChartInstance.current = null;\n    }\n\n    // График исходных данных\n    if (originalChartRef.current) {\n      const ctx = originalChartRef.current.getContext(\"2d\");\n      originalChartInstance.current = new Chart(ctx, {\n        type: \"line\",\n        data: {\n          datasets: data.original\n        },\n        options: buildOptions(\"Исходные сигналы\", \"Сигнал (В)\")\n      });\n    }\n\n    // График обработанных данных\n    if (processedChartRef.current) {\n      const ctx = processedChartRef.current.getContext(\"2d\");\n      processedChartInstance.current = new Chart(ctx, {\n        type: \"line\",\n        data: {\n          datasets: data.processed\n        },\n        options: buildOptions(\"Обработанные сигналы\", \"Сигнал\")\n      });\n    }\n    return () => {\n      if (originalChartInstance.current) {\n        originalChartInstance.current.destroy();\n        originalChartInstance.current = null;\n      }\n      if (processedChartInstance.current) {\n        processedChartInstance.current.destroy();\n        processedChartInstance.current = null;\n      }\n    };\n  }, [data]);\n  useEffect(() => {\n    if (data !== null && data !== void 0 && data.original) {\n      const visibilityMap = {};\n      data.original.forEach(dataset => {\n        if (dataset.intersectionMarker) return;\n        visibilityMap[dataset.label] = true;\n      });\n      setOriginalAxisVisibility(visibilityMap);\n    }\n    if (data !== null && data !== void 0 && data.processed) {\n      const visibilityMap = {};\n      data.processed.forEach(dataset => {\n        if (dataset !== null && dataset !== void 0 && dataset.intersectionMarker) return;\n        visibilityMap[dataset.label] = true;\n      });\n      setProcessedAxisVisibility(visibilityMap);\n    }\n\n    // Инициализируем текущие пересечения\n    if (data !== null && data !== void 0 && data.intersections) {\n      setCurrentIntersections(data.intersections);\n    }\n  }, [data]);\n\n  // Обновление графиков при изменении сдвига тензосигнала\n  useEffect(() => {\n    if (!(data !== null && data !== void 0 && data.rawData) || !originalChartInstance.current || !processedChartInstance.current) {\n      return;\n    }\n    const {\n      t,\n      tenz,\n      interfCorrected\n    } = data.rawData;\n\n    // Обновляем тензосигнал с учетом сдвига\n    const shiftedTenz = tenz.map(val => val + tenzOffset);\n\n    // Обновляем график исходных данных\n    const originalChart = originalChartInstance.current;\n    const tenzDatasetIndex = originalChart.data.datasets.findIndex(ds => ds.label === \"Тензометрический сигнал (CH1)\");\n    if (tenzDatasetIndex !== -1) {\n      originalChart.data.datasets[tenzDatasetIndex].data = t.map((time, idx) => ({\n        x: time,\n        y: shiftedTenz[idx]\n      }));\n    }\n\n    // Пересчитываем пересечения\n    const newIntersections = [];\n    const yThreshold = 0.02;\n    for (let i = 1; i < interfCorrected.length; i++) {\n      const diffPrev = shiftedTenz[i - 1] - interfCorrected[i - 1];\n      const diffCurr = shiftedTenz[i] - interfCorrected[i];\n      if (diffPrev <= 0 && diffCurr > 0 || diffPrev >= 0 && diffCurr < 0) {\n        const t1 = t[i - 1];\n        const t2 = t[i];\n        const diffDelta = diffCurr - diffPrev;\n        if (diffDelta === 0) continue;\n        const ratio = -diffPrev / diffDelta;\n        const time = t1 + ratio * (t2 - t1);\n        const tenzValue = shiftedTenz[i - 1] + ratio * (shiftedTenz[i] - shiftedTenz[i - 1]);\n        const interfValue = interfCorrected[i - 1] + ratio * (interfCorrected[i] - interfCorrected[i - 1]);\n        const value = (tenzValue + interfValue) / 2;\n        if (Math.abs(value) <= yThreshold) {\n          newIntersections.push({\n            time,\n            value\n          });\n        }\n      }\n    }\n\n    // Обновляем пересечения на графике исходных данных\n    // Обновляем датасет с intersectionMarker (если есть)\n    const intersectionMarkerIndex = originalChart.data.datasets.findIndex(ds => ds.intersectionMarker);\n    if (intersectionMarkerIndex !== -1) {\n      originalChart.data.datasets[intersectionMarkerIndex].data = newIntersections.map(({\n        time,\n        value\n      }) => ({\n        x: time,\n        y: value\n      }));\n\n      // Обновляем метку с актуальным значением Y\n      const avgY = newIntersections.length > 0 ? newIntersections.reduce((acc, p) => acc + p.value, 0) / newIntersections.length : 0;\n      originalChart.data.datasets[intersectionMarkerIndex].label = `Пересечения при Y=${avgY.toFixed(4)}`;\n    }\n\n    // Обновляем обычный датасет пересечений на original графике\n    const originalIntersectionDatasetIndex = originalChart.data.datasets.findIndex(ds => ds.label === \"Пересечения тензо и интерф\");\n    if (originalIntersectionDatasetIndex !== -1) {\n      originalChart.data.datasets[originalIntersectionDatasetIndex].data = newIntersections.map(({\n        time,\n        value\n      }) => ({\n        x: time,\n        y: value\n      }));\n    }\n\n    // Обновляем состояние для таблицы пересечений\n    setCurrentIntersections(newIntersections);\n\n    // Обновляем обработанный график\n    const processedChart = processedChartInstance.current;\n\n    // Обновляем график пересечений на processed графике\n    const processedIntersectionDatasetIndex = processedChart.data.datasets.findIndex(ds => ds.label === \"Пересечения тензо и интерф\");\n    if (processedIntersectionDatasetIndex !== -1) {\n      processedChart.data.datasets[processedIntersectionDatasetIndex].data = newIntersections.map(({\n        time,\n        value\n      }) => ({\n        x: time,\n        y: value\n      }));\n    }\n\n    // Обновляем обработанный сигнал (скорректированный тензосигнал), если он есть\n    const correctedDatasetIndex = processedChart.data.datasets.findIndex(ds => ds.label === \"Скорректированный тензосигнал\");\n    if (correctedDatasetIndex !== -1) {\n      processedChart.data.datasets[correctedDatasetIndex].data = t.map((time, idx) => ({\n        x: time + 50e-6,\n        // коррекция времени\n        y: -shiftedTenz[idx] * 5000 + 0.38 // преобразование с учетом сдвига\n      }));\n    }\n    originalChart.update(\"none\");\n    processedChart.update(\"none\");\n  }, [tenzOffset, data === null || data === void 0 ? void 0 : data.rawData]);\n  const handleResetOriginal = useCallback(() => {\n    var _originalChartInstanc;\n    (_originalChartInstanc = originalChartInstance.current) === null || _originalChartInstanc === void 0 ? void 0 : _originalChartInstanc.resetZoom();\n  }, []);\n  const handleResetProcessed = useCallback(() => {\n    var _processedChartInstan;\n    (_processedChartInstan = processedChartInstance.current) === null || _processedChartInstan === void 0 ? void 0 : _processedChartInstan.resetZoom();\n  }, []);\n  const zoomChart = useCallback((chartRef, factor) => {\n    var _chartRef$current;\n    (_chartRef$current = chartRef.current) === null || _chartRef$current === void 0 ? void 0 : _chartRef$current.zoom({\n      x: factor,\n      y: factor\n    });\n  }, []);\n  const handleZoomOriginalIn = useCallback(() => {\n    zoomChart(originalChartInstance, ZOOM_STEP);\n  }, [zoomChart]);\n  const handleZoomOriginalOut = useCallback(() => {\n    zoomChart(originalChartInstance, 1 / ZOOM_STEP);\n  }, [zoomChart]);\n  const handleZoomProcessedIn = useCallback(() => {\n    zoomChart(processedChartInstance, ZOOM_STEP);\n  }, [zoomChart]);\n  const handleZoomProcessedOut = useCallback(() => {\n    zoomChart(processedChartInstance, 1 / ZOOM_STEP);\n  }, [zoomChart]);\n  const handleAxisToggle = useCallback((chartInstanceRef, label, visibilityState, setVisibilityState) => {\n    var _visibilityState$labe;\n    const current = (_visibilityState$labe = visibilityState[label]) !== null && _visibilityState$labe !== void 0 ? _visibilityState$labe : true;\n    const next = !current;\n    setVisibilityState(prev => ({\n      ...prev,\n      [label]: next\n    }));\n    const chart = chartInstanceRef.current;\n    if (!chart) return;\n    const datasetIndex = chart.data.datasets.findIndex(dataset => dataset.label === label);\n    if (datasetIndex === -1) return;\n    chart.setDatasetVisibility(datasetIndex, next);\n    chart.update(\"none\");\n  }, []);\n  const originalAxisOptions = useMemo(() => {\n    var _data$original;\n    return ((_data$original = data === null || data === void 0 ? void 0 : data.original) !== null && _data$original !== void 0 ? _data$original : []).filter(dataset => !dataset.intersectionMarker).map(dataset => ({\n      label: dataset.label,\n      color: dataset.borderColor\n    }));\n  }, [data]);\n\n  // Вычисляем среднее значение Y для пересечений\n  const averageY = useMemo(() => {\n    if (currentIntersections.length === 0) return 0;\n    const sum = currentIntersections.reduce((acc, point) => acc + point.value, 0);\n    return sum / currentIntersections.length;\n  }, [currentIntersections]);\n  const intersectionDataset = useMemo(() => {\n    var _data$original2;\n    const dataset = ((_data$original2 = data === null || data === void 0 ? void 0 : data.original) !== null && _data$original2 !== void 0 ? _data$original2 : []).find(dataset => dataset.intersectionMarker);\n    if (dataset) {\n      return {\n        ...dataset,\n        label: `Пересечения при Y=${averageY.toFixed(4)}`\n      };\n    }\n    return dataset;\n  }, [data, averageY]);\n  const handleIntersectionToggle = useCallback(() => {\n    const next = !intersectionVisibility;\n    setIntersectionVisibility(next);\n    const chart = originalChartInstance.current;\n    if (!chart || !intersectionDataset) return;\n    const datasetIndex = chart.data.datasets.findIndex(dataset => dataset.intersectionMarker);\n    if (datasetIndex === -1) return;\n    chart.setDatasetVisibility(datasetIndex, next);\n    chart.update(\"none\");\n  }, [intersectionVisibility, intersectionDataset]);\n  const processedAxisOptions = useMemo(() => {\n    var _data$processed;\n    return ((_data$processed = data === null || data === void 0 ? void 0 : data.processed) !== null && _data$processed !== void 0 ? _data$processed : []).map(dataset => ({\n      label: dataset.label,\n      color: dataset.borderColor\n    }));\n  }, [data]);\n\n  // Определяем диапазон для сдвига\n  const offsetRange = useMemo(() => {\n    var _data$rawData;\n    if (!(data !== null && data !== void 0 && (_data$rawData = data.rawData) !== null && _data$rawData !== void 0 && _data$rawData.tenz)) {\n      return {\n        min: -1,\n        max: 1,\n        step: 0.001\n      };\n    }\n    const values = data.rawData.tenz;\n    const range = Math.max(...values) - Math.min(...values);\n    return {\n      min: -range,\n      max: range,\n      step: range / 1000\n    };\n  }, [data === null || data === void 0 ? void 0 : data.rawData]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"charts-wrapper\",\n    children: [(data === null || data === void 0 ? void 0 : data.rawData) && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"tenz-offset-control\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"tenz-offset-input\",\n        className: \"tenz-offset-label\",\n        children: \"\\u0421\\u0434\\u0432\\u0438\\u0433 \\u0442\\u0435\\u043D\\u0437\\u043E\\u043C\\u0435\\u0442\\u0440\\u0438\\u0447\\u0435\\u0441\\u043A\\u043E\\u0433\\u043E \\u0441\\u0438\\u0433\\u043D\\u0430\\u043B\\u0430 (CH1) \\u043F\\u043E \\u043E\\u0441\\u0438 Y:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tenz-offset-input-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"tenz-offset-input\",\n          type: \"range\",\n          min: offsetRange.min,\n          max: offsetRange.max,\n          step: offsetRange.step,\n          value: tenzOffset,\n          onChange: e => setTenzOffset(parseFloat(e.target.value)),\n          className: \"tenz-offset-slider\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          min: offsetRange.min,\n          max: offsetRange.max,\n          step: offsetRange.step,\n          value: tenzOffset,\n          onChange: e => setTenzOffset(parseFloat(e.target.value) || 0),\n          className: \"tenz-offset-number\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 461,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"tenz-offset-reset-btn\",\n          onClick: () => setTenzOffset(0),\n          \"aria-label\": \"\\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C \\u0441\\u0434\\u0432\\u0438\\u0433\",\n          children: \"\\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"chart-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chart-controls-group\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"zoom-controls\",\n          role: \"group\",\n          \"aria-label\": \"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\\u043E\\u043C\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"zoom-control-btn\",\n            onClick: handleZoomOriginalOut,\n            \"aria-label\": \"\\u0423\\u043C\\u0435\\u043D\\u044C\\u0448\\u0438\\u0442\\u044C \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\",\n            children: \"-\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 486,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"zoom-control-btn\",\n            onClick: handleZoomOriginalIn,\n            \"aria-label\": \"\\u0423\\u0432\\u0435\\u043B\\u0438\\u0447\\u0438\\u0442\\u044C \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\",\n            children: \"+\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 494,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"zoom-reset-btn\",\n            onClick: handleResetOriginal,\n            \"aria-label\": \"\\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\",\n            children: \"\\u21BA \\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 502,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 9\n      }, this), originalAxisOptions.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"axis-toggle-group\",\n        role: \"group\",\n        \"aria-label\": \"\\u041E\\u0442\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435 \\u043E\\u0441\\u0435\\u0439 \\u0438\\u0441\\u0445\\u043E\\u0434\\u043D\\u044B\\u0445 \\u0441\\u0438\\u0433\\u043D\\u0430\\u043B\\u043E\\u0432\",\n        children: [originalAxisOptions.map(({\n          label,\n          color\n        }) => {\n          var _originalAxisVisibili;\n          const isActive = (_originalAxisVisibili = originalAxisVisibility[label]) !== null && _originalAxisVisibili !== void 0 ? _originalAxisVisibili : true;\n          return /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: `axis-toggle-btn ${isActive ? \"axis-toggle-btn--active\" : \"\"}`,\n            onClick: () => handleAxisToggle(originalChartInstance, label, originalAxisVisibility, setOriginalAxisVisibility),\n            \"aria-pressed\": isActive,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"axis-toggle-btn__indicator\",\n              style: {\n                borderColor: color,\n                backgroundColor: isActive ? color : \"transparent\"\n              },\n              \"aria-hidden\": \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 537,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"axis-toggle-btn__label\",\n              children: label\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 545,\n              columnNumber: 19\n            }, this)]\n          }, label, true, {\n            fileName: _jsxFileName,\n            lineNumber: 521,\n            columnNumber: 17\n          }, this);\n        }), intersectionDataset && /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: `axis-toggle-btn ${intersectionVisibility ? \"axis-toggle-btn--active\" : \"\"}`,\n          onClick: handleIntersectionToggle,\n          \"aria-pressed\": intersectionVisibility,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"axis-toggle-btn__indicator\",\n            style: {\n              borderColor: \"#000000\",\n              backgroundColor: intersectionVisibility ? \"#000000\" : \"transparent\"\n            },\n            \"aria-hidden\": \"true\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 558,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"axis-toggle-btn__label\",\n            children: intersectionDataset.label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 568,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 550,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 513,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: originalChartRef,\n        width: \"800\",\n        height: \"400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 575,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 483,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"chart-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chart-controls-group\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"zoom-controls\",\n          role: \"group\",\n          \"aria-label\": \"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\\u043E\\u043C\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"zoom-control-btn\",\n            onClick: handleZoomProcessedOut,\n            \"aria-label\": \"\\u0423\\u043C\\u0435\\u043D\\u044C\\u0448\\u0438\\u0442\\u044C \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\",\n            children: \"-\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"zoom-control-btn\",\n            onClick: handleZoomProcessedIn,\n            \"aria-label\": \"\\u0423\\u0432\\u0435\\u043B\\u0438\\u0447\\u0438\\u0442\\u044C \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\",\n            children: \"+\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 589,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"zoom-reset-btn\",\n            onClick: handleResetProcessed,\n            \"aria-label\": \"\\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\",\n            children: \"\\u21BA \\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 597,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 579,\n        columnNumber: 9\n      }, this), processedAxisOptions.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"axis-toggle-group\",\n        role: \"group\",\n        \"aria-label\": \"\\u041E\\u0442\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435 \\u043E\\u0441\\u0435\\u0439 \\u043E\\u0431\\u0440\\u0430\\u0431\\u043E\\u0442\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0441\\u0438\\u0433\\u043D\\u0430\\u043B\\u043E\\u0432\",\n        children: processedAxisOptions.map(({\n          label,\n          color\n        }) => {\n          var _processedAxisVisibil;\n          const isActive = (_processedAxisVisibil = processedAxisVisibility[label]) !== null && _processedAxisVisibil !== void 0 ? _processedAxisVisibil : true;\n          return /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: `axis-toggle-btn ${isActive ? \"axis-toggle-btn--active\" : \"\"}`,\n            onClick: () => handleAxisToggle(processedChartInstance, label, processedAxisVisibility, setProcessedAxisVisibility),\n            \"aria-pressed\": isActive,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"axis-toggle-btn__indicator\",\n              style: {\n                borderColor: color,\n                backgroundColor: isActive ? color : \"transparent\"\n              },\n              \"aria-hidden\": \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 632,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"axis-toggle-btn__label\",\n              children: label\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 640,\n              columnNumber: 19\n            }, this)]\n          }, label, true, {\n            fileName: _jsxFileName,\n            lineNumber: 616,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 608,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: processedChartRef,\n        width: \"800\",\n        height: \"400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 646,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 578,\n      columnNumber: 7\n    }, this), currentIntersections.length > 0 && /*#__PURE__*/_jsxDEV(\"aside\", {\n      className: \"intersection-panel\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"intersection-panel__header\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chart-chip chart-chip--highlight\",\n          children: [\"\\u041F\\u0435\\u0440\\u0435\\u0441\\u0435\\u0447\\u0435\\u043D\\u0438\\u044F Y=\", averageY.toFixed(4)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 651,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u041E\\u0431\\u0449\\u0438\\u0435 \\u0442\\u043E\\u0447\\u043A\\u0438 t\\u0435\\u043D\\u0437\\u043E \\u0438 \\u0438\\u043D\\u0442\\u0435\\u0440\\u0444\\u0435\\u0440\\u043E\\u0441\\u0438\\u0433\\u043D\\u0430\\u043B\\u0430\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 654,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 650,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"intersection-table-wrapper\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"intersection-table\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"#\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 660,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"\\u0412\\u0440\\u0435\\u043C\\u044F (\\u0441)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 661,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"\\u0410\\u043C\\u043F\\u043B\\u0438\\u0442\\u0443\\u0434\\u0430 (\\u0412)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 662,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 659,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 658,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: currentIntersections.map((point, idx) => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: idx + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 668,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: formatTime(point.time)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 669,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: formatSignal(point.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 670,\n                columnNumber: 21\n              }, this)]\n            }, `${point.time}-${idx}`, true, {\n              fileName: _jsxFileName,\n              lineNumber: 667,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 665,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 657,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 656,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 649,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 444,\n    columnNumber: 5\n  }, this);\n};\n_s(ChartComponent, \"L1VJuMI+WMHg2sObGoFf7TmjJcQ=\");\n_c = ChartComponent;\nexport default ChartComponent;\nvar _c;\n$RefreshReg$(_c, \"ChartComponent\");","map":{"version":3,"names":["React","useEffect","useRef","useCallback","useState","useMemo","Chart","registerables","zoomPlugin","jsxDEV","_jsxDEV","intersectionMarkerPlugin","id","afterDatasetsDraw","chart","ctx","data","datasets","forEach","dataset","datasetIndex","intersectionMarker","meta","getDatasetMeta","isDatasetVisible","element","_dataset$markerSize","_dataset$markerColor","_dataset$markerAlpha","_dataset$markerLineWi","x","y","undefined","isNaN","size","markerSize","save","strokeStyle","markerColor","globalAlpha","markerAlpha","lineWidth","markerLineWidth","lineCap","beginPath","moveTo","lineTo","stroke","restore","register","ZOOM_STEP","ChartComponent","_s","_data$intersections","originalChartRef","processedChartRef","originalChartInstance","processedChartInstance","intersections","originalAxisVisibility","setOriginalAxisVisibility","processedAxisVisibility","setProcessedAxisVisibility","intersectionVisibility","setIntersectionVisibility","tenzOffset","setTenzOffset","currentIntersections","setCurrentIntersections","formatTime","value","toExponential","formatSignal","toFixed","buildOptions","title","yLabel","responsive","interaction","mode","intersect","scales","type","display","text","plugins","legend","tooltip","enabled","callbacks","label","context","point","raw","xValue","yValue","zoom","pan","wheel","modifierKey","pinch","drag","current","destroy","getContext","original","options","processed","visibilityMap","rawData","t","tenz","interfCorrected","shiftedTenz","map","val","originalChart","tenzDatasetIndex","findIndex","ds","time","idx","newIntersections","yThreshold","i","length","diffPrev","diffCurr","t1","t2","diffDelta","ratio","tenzValue","interfValue","Math","abs","push","intersectionMarkerIndex","avgY","reduce","acc","p","originalIntersectionDatasetIndex","processedChart","processedIntersectionDatasetIndex","correctedDatasetIndex","update","handleResetOriginal","_originalChartInstanc","resetZoom","handleResetProcessed","_processedChartInstan","zoomChart","chartRef","factor","_chartRef$current","handleZoomOriginalIn","handleZoomOriginalOut","handleZoomProcessedIn","handleZoomProcessedOut","handleAxisToggle","chartInstanceRef","visibilityState","setVisibilityState","_visibilityState$labe","next","prev","setDatasetVisibility","originalAxisOptions","_data$original","filter","color","borderColor","averageY","sum","intersectionDataset","_data$original2","find","handleIntersectionToggle","processedAxisOptions","_data$processed","offsetRange","_data$rawData","min","max","step","values","range","className","children","htmlFor","fileName","_jsxFileName","lineNumber","columnNumber","onChange","e","parseFloat","target","onClick","role","_originalAxisVisibili","isActive","style","backgroundColor","ref","width","height","_processedAxisVisibil","_c","$RefreshReg$"],"sources":["C:/Users/Иван/Desktop/signal-analyzer1/src/ChartComponent.jsx"],"sourcesContent":["import React, { useEffect, useRef, useCallback, useState, useMemo } from \"react\";\r\nimport { Chart, registerables } from \"chart.js\";\r\nimport zoomPlugin from \"chartjs-plugin-zoom\";\r\n\r\nconst intersectionMarkerPlugin = {\r\n  id: \"intersectionMarker\",\r\n  afterDatasetsDraw(chart) {\r\n    const { ctx } = chart;\r\n    chart.data.datasets.forEach((dataset, datasetIndex) => {\r\n      if (!dataset?.intersectionMarker) return;\r\n\r\n      const meta = chart.getDatasetMeta(datasetIndex);\r\n      if (!chart.isDatasetVisible(datasetIndex)) return;\r\n\r\n      meta.data.forEach((element) => {\r\n        // Используем точные координаты элемента после всех трансформаций\r\n        const x = element.x;\r\n        const y = element.y;\r\n        \r\n        // Проверяем, что элемент видим на canvas\r\n        if (x === undefined || y === undefined || isNaN(x) || isNaN(y)) return;\r\n        \r\n        const size = dataset.markerSize ?? 6;\r\n\r\n        ctx.save();\r\n        ctx.strokeStyle = dataset.markerColor ?? \"#000000\";\r\n        ctx.globalAlpha = dataset.markerAlpha ?? 0.8;\r\n        ctx.lineWidth = dataset.markerLineWidth ?? 2;\r\n        ctx.lineCap = \"round\";\r\n        ctx.beginPath();\r\n        ctx.moveTo(x - size, y - size);\r\n        ctx.lineTo(x + size, y + size);\r\n        ctx.moveTo(x - size, y + size);\r\n        ctx.lineTo(x + size, y - size);\r\n        ctx.stroke();\r\n        ctx.restore();\r\n      });\r\n    });\r\n  },\r\n};\r\n\r\nChart.register(...registerables, zoomPlugin, intersectionMarkerPlugin);\r\n\r\nconst ZOOM_STEP = 1.25;\r\n\r\nconst ChartComponent = ({ data }) => {\r\n  const originalChartRef = useRef(null);\r\n  const processedChartRef = useRef(null);\r\n  const originalChartInstance = useRef(null);\r\n  const processedChartInstance = useRef(null);\r\n  const intersections = data?.intersections ?? [];\r\n  const [originalAxisVisibility, setOriginalAxisVisibility] = useState({});\r\n  const [processedAxisVisibility, setProcessedAxisVisibility] = useState({});\r\n  const [intersectionVisibility, setIntersectionVisibility] = useState(true);\r\n  const [tenzOffset, setTenzOffset] = useState(0); // Сдвиг тензосигнала по Y\r\n  const [currentIntersections, setCurrentIntersections] = useState([]); // Текущие пересечения\r\n\r\n  const formatTime = (value) => {\r\n    if (typeof value !== \"number\") return \"-\";\r\n    return value.toExponential(3);\r\n  };\r\n\r\n  const formatSignal = (value) => {\r\n    if (typeof value !== \"number\") return \"-\";\r\n    return value.toFixed(5);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!data) return;\r\n\r\n    const buildOptions = (title, yLabel) => ({\r\n      responsive: true,\r\n      interaction: {\r\n        mode: \"index\",\r\n        intersect: false,\r\n      },\r\n      scales: {\r\n        x: {\r\n          type: \"linear\",\r\n          title: {\r\n            display: true,\r\n            text: \"Время (секунды)\",\r\n          },\r\n        },\r\n        y: {\r\n          type: \"linear\",\r\n          title: {\r\n            display: true,\r\n            text: yLabel,\r\n          },\r\n        },\r\n      },\r\n      plugins: {\r\n        title: {\r\n          display: true,\r\n          text: title,\r\n        },\r\n        legend: {\r\n          display: true,\r\n        },\r\n        tooltip: {\r\n          enabled: true,\r\n          callbacks: {\r\n            label: function(context) {\r\n              const point = context.raw;\r\n              const xValue = typeof point.x === 'number' \r\n                ? point.x.toExponential(4) \r\n                : point.x;\r\n              const yValue = typeof point.y === 'number' \r\n                ? point.y.toFixed(6) \r\n                : point.y;\r\n              return [\r\n                `${context.dataset.label || ''}`,\r\n                `X: ${xValue} с`,\r\n                `Y: ${yValue}`\r\n              ];\r\n            },\r\n          },\r\n        },\r\n        zoom: {\r\n          pan: {\r\n            enabled: true,\r\n            mode: \"xy\",\r\n          },\r\n          zoom: {\r\n            wheel: {\r\n              enabled: true,\r\n              modifierKey: \"ctrl\",\r\n            },\r\n            pinch: {\r\n              enabled: true,\r\n            },\r\n            drag: {\r\n              enabled: false,\r\n            },\r\n            mode: \"xy\",\r\n          },\r\n        },\r\n      },\r\n    });\r\n\r\n    if (originalChartInstance.current) {\r\n      originalChartInstance.current.destroy();\r\n      originalChartInstance.current = null;\r\n    }\r\n\r\n    if (processedChartInstance.current) {\r\n      processedChartInstance.current.destroy();\r\n      processedChartInstance.current = null;\r\n    }\r\n\r\n    // График исходных данных\r\n    if (originalChartRef.current) {\r\n      const ctx = originalChartRef.current.getContext(\"2d\");\r\n      originalChartInstance.current = new Chart(ctx, {\r\n        type: \"line\",\r\n        data: {\r\n          datasets: data.original,\r\n        },\r\n        options: buildOptions(\"Исходные сигналы\", \"Сигнал (В)\"),\r\n      });\r\n    }\r\n\r\n    // График обработанных данных\r\n    if (processedChartRef.current) {\r\n      const ctx = processedChartRef.current.getContext(\"2d\");\r\n      processedChartInstance.current = new Chart(ctx, {\r\n        type: \"line\",\r\n        data: {\r\n          datasets: data.processed,\r\n        },\r\n        options: buildOptions(\"Обработанные сигналы\", \"Сигнал\"),\r\n      });\r\n    }\r\n\r\n    return () => {\r\n      if (originalChartInstance.current) {\r\n        originalChartInstance.current.destroy();\r\n        originalChartInstance.current = null;\r\n      }\r\n      if (processedChartInstance.current) {\r\n        processedChartInstance.current.destroy();\r\n        processedChartInstance.current = null;\r\n      }\r\n    };\r\n  }, [data]);\r\n\r\n  useEffect(() => {\r\n    if (data?.original) {\r\n      const visibilityMap = {};\r\n      data.original.forEach((dataset) => {\r\n        if (dataset.intersectionMarker) return;\r\n        visibilityMap[dataset.label] = true;\r\n      });\r\n      setOriginalAxisVisibility(visibilityMap);\r\n    }\r\n\r\n    if (data?.processed) {\r\n      const visibilityMap = {};\r\n      data.processed.forEach((dataset) => {\r\n        if (dataset?.intersectionMarker) return;\r\n        visibilityMap[dataset.label] = true;\r\n      });\r\n      setProcessedAxisVisibility(visibilityMap);\r\n    }\r\n\r\n    // Инициализируем текущие пересечения\r\n    if (data?.intersections) {\r\n      setCurrentIntersections(data.intersections);\r\n    }\r\n  }, [data]);\r\n\r\n  // Обновление графиков при изменении сдвига тензосигнала\r\n  useEffect(() => {\r\n    if (!data?.rawData || !originalChartInstance.current || !processedChartInstance.current) {\r\n      return;\r\n    }\r\n\r\n    const { t, tenz, interfCorrected } = data.rawData;\r\n    \r\n    // Обновляем тензосигнал с учетом сдвига\r\n    const shiftedTenz = tenz.map((val) => val + tenzOffset);\r\n    \r\n    // Обновляем график исходных данных\r\n    const originalChart = originalChartInstance.current;\r\n    const tenzDatasetIndex = originalChart.data.datasets.findIndex(\r\n      (ds) => ds.label === \"Тензометрический сигнал (CH1)\"\r\n    );\r\n    \r\n    if (tenzDatasetIndex !== -1) {\r\n      originalChart.data.datasets[tenzDatasetIndex].data = t.map((time, idx) => ({\r\n        x: time,\r\n        y: shiftedTenz[idx],\r\n      }));\r\n    }\r\n\r\n    // Пересчитываем пересечения\r\n    const newIntersections = [];\r\n    const yThreshold = 0.02;\r\n    for (let i = 1; i < interfCorrected.length; i++) {\r\n      const diffPrev = shiftedTenz[i - 1] - interfCorrected[i - 1];\r\n      const diffCurr = shiftedTenz[i] - interfCorrected[i];\r\n\r\n      if ((diffPrev <= 0 && diffCurr > 0) || (diffPrev >= 0 && diffCurr < 0)) {\r\n        const t1 = t[i - 1];\r\n        const t2 = t[i];\r\n        const diffDelta = diffCurr - diffPrev;\r\n\r\n        if (diffDelta === 0) continue;\r\n\r\n        const ratio = -diffPrev / diffDelta;\r\n        const time = t1 + ratio * (t2 - t1);\r\n        const tenzValue = shiftedTenz[i - 1] + ratio * (shiftedTenz[i] - shiftedTenz[i - 1]);\r\n        const interfValue = interfCorrected[i - 1] + ratio * (interfCorrected[i] - interfCorrected[i - 1]);\r\n        const value = (tenzValue + interfValue) / 2;\r\n\r\n        if (Math.abs(value) <= yThreshold) {\r\n          newIntersections.push({ time, value });\r\n        }\r\n      }\r\n    }\r\n\r\n    // Обновляем пересечения на графике исходных данных\r\n    // Обновляем датасет с intersectionMarker (если есть)\r\n    const intersectionMarkerIndex = originalChart.data.datasets.findIndex(\r\n      (ds) => ds.intersectionMarker\r\n    );\r\n    if (intersectionMarkerIndex !== -1) {\r\n      originalChart.data.datasets[intersectionMarkerIndex].data = newIntersections.map(\r\n        ({ time, value }) => ({ x: time, y: value })\r\n      );\r\n      \r\n      // Обновляем метку с актуальным значением Y\r\n      const avgY = newIntersections.length > 0\r\n        ? newIntersections.reduce((acc, p) => acc + p.value, 0) / newIntersections.length\r\n        : 0;\r\n      originalChart.data.datasets[intersectionMarkerIndex].label = \r\n        `Пересечения при Y=${avgY.toFixed(4)}`;\r\n    }\r\n    \r\n    // Обновляем обычный датасет пересечений на original графике\r\n    const originalIntersectionDatasetIndex = originalChart.data.datasets.findIndex(\r\n      (ds) => ds.label === \"Пересечения тензо и интерф\"\r\n    );\r\n    if (originalIntersectionDatasetIndex !== -1) {\r\n      originalChart.data.datasets[originalIntersectionDatasetIndex].data = newIntersections.map(\r\n        ({ time, value }) => ({ x: time, y: value })\r\n      );\r\n    }\r\n\r\n    // Обновляем состояние для таблицы пересечений\r\n    setCurrentIntersections(newIntersections);\r\n\r\n    // Обновляем обработанный график\r\n    const processedChart = processedChartInstance.current;\r\n    \r\n    // Обновляем график пересечений на processed графике\r\n    const processedIntersectionDatasetIndex = processedChart.data.datasets.findIndex(\r\n      (ds) => ds.label === \"Пересечения тензо и интерф\"\r\n    );\r\n    if (processedIntersectionDatasetIndex !== -1) {\r\n      processedChart.data.datasets[processedIntersectionDatasetIndex].data = newIntersections.map(\r\n        ({ time, value }) => ({ x: time, y: value })\r\n      );\r\n    }\r\n    \r\n    // Обновляем обработанный сигнал (скорректированный тензосигнал), если он есть\r\n    const correctedDatasetIndex = processedChart.data.datasets.findIndex(\r\n      (ds) => ds.label === \"Скорректированный тензосигнал\"\r\n    );\r\n    \r\n    if (correctedDatasetIndex !== -1) {\r\n      processedChart.data.datasets[correctedDatasetIndex].data = t.map((time, idx) => ({\r\n        x: time + 50e-6, // коррекция времени\r\n        y: -shiftedTenz[idx] * 5000 + 0.38, // преобразование с учетом сдвига\r\n      }));\r\n    }\r\n\r\n    originalChart.update(\"none\");\r\n    processedChart.update(\"none\");\r\n  }, [tenzOffset, data?.rawData]);\r\n\r\n  const handleResetOriginal = useCallback(() => {\r\n    originalChartInstance.current?.resetZoom();\r\n  }, []);\r\n\r\n  const handleResetProcessed = useCallback(() => {\r\n    processedChartInstance.current?.resetZoom();\r\n  }, []);\r\n\r\n  const zoomChart = useCallback((chartRef, factor) => {\r\n    chartRef.current?.zoom({ x: factor, y: factor });\r\n  }, []);\r\n\r\n  const handleZoomOriginalIn = useCallback(() => {\r\n    zoomChart(originalChartInstance, ZOOM_STEP);\r\n  }, [zoomChart]);\r\n\r\n  const handleZoomOriginalOut = useCallback(() => {\r\n    zoomChart(originalChartInstance, 1 / ZOOM_STEP);\r\n  }, [zoomChart]);\r\n\r\n  const handleZoomProcessedIn = useCallback(() => {\r\n    zoomChart(processedChartInstance, ZOOM_STEP);\r\n  }, [zoomChart]);\r\n\r\n  const handleZoomProcessedOut = useCallback(() => {\r\n    zoomChart(processedChartInstance, 1 / ZOOM_STEP);\r\n  }, [zoomChart]);\r\n\r\n  const handleAxisToggle = useCallback(\r\n    (chartInstanceRef, label, visibilityState, setVisibilityState) => {\r\n      const current = visibilityState[label] ?? true;\r\n      const next = !current;\r\n\r\n      setVisibilityState((prev) => ({\r\n        ...prev,\r\n        [label]: next,\r\n      }));\r\n\r\n      const chart = chartInstanceRef.current;\r\n      if (!chart) return;\r\n\r\n      const datasetIndex = chart.data.datasets.findIndex(\r\n        (dataset) => dataset.label === label\r\n      );\r\n\r\n      if (datasetIndex === -1) return;\r\n\r\n      chart.setDatasetVisibility(datasetIndex, next);\r\n      chart.update(\"none\");\r\n    },\r\n    []\r\n  );\r\n\r\n  const originalAxisOptions = useMemo(() => {\r\n    return (data?.original ?? [])\r\n      .filter((dataset) => !dataset.intersectionMarker)\r\n      .map((dataset) => ({\r\n        label: dataset.label,\r\n        color: dataset.borderColor,\r\n      }));\r\n  }, [data]);\r\n\r\n  // Вычисляем среднее значение Y для пересечений\r\n  const averageY = useMemo(() => {\r\n    if (currentIntersections.length === 0) return 0;\r\n    const sum = currentIntersections.reduce((acc, point) => acc + point.value, 0);\r\n    return sum / currentIntersections.length;\r\n  }, [currentIntersections]);\r\n\r\n  const intersectionDataset = useMemo(() => {\r\n    const dataset = (data?.original ?? []).find(\r\n      (dataset) => dataset.intersectionMarker\r\n    );\r\n    if (dataset) {\r\n      return {\r\n        ...dataset,\r\n        label: `Пересечения при Y=${averageY.toFixed(4)}`,\r\n      };\r\n    }\r\n    return dataset;\r\n  }, [data, averageY]);\r\n\r\n  const handleIntersectionToggle = useCallback(() => {\r\n    const next = !intersectionVisibility;\r\n    setIntersectionVisibility(next);\r\n\r\n    const chart = originalChartInstance.current;\r\n    if (!chart || !intersectionDataset) return;\r\n\r\n    const datasetIndex = chart.data.datasets.findIndex(\r\n      (dataset) => dataset.intersectionMarker\r\n    );\r\n\r\n    if (datasetIndex === -1) return;\r\n\r\n    chart.setDatasetVisibility(datasetIndex, next);\r\n    chart.update(\"none\");\r\n  }, [intersectionVisibility, intersectionDataset]);\r\n\r\n  const processedAxisOptions = useMemo(() => {\r\n    return (data?.processed ?? []).map((dataset) => ({\r\n      label: dataset.label,\r\n      color: dataset.borderColor,\r\n    }));\r\n  }, [data]);\r\n\r\n  // Определяем диапазон для сдвига\r\n  const offsetRange = useMemo(() => {\r\n    if (!data?.rawData?.tenz) {\r\n      return { min: -1, max: 1, step: 0.001 };\r\n    }\r\n    const values = data.rawData.tenz;\r\n    const range = Math.max(...values) - Math.min(...values);\r\n    return {\r\n      min: -range,\r\n      max: range,\r\n      step: range / 1000,\r\n    };\r\n  }, [data?.rawData]);\r\n\r\n  return (\r\n    <div className=\"charts-wrapper\">\r\n      {data?.rawData && (\r\n        <div className=\"tenz-offset-control\">\r\n          <label htmlFor=\"tenz-offset-input\" className=\"tenz-offset-label\">\r\n            Сдвиг тензометрического сигнала (CH1) по оси Y:\r\n          </label>\r\n          <div className=\"tenz-offset-input-group\">\r\n            <input\r\n              id=\"tenz-offset-input\"\r\n              type=\"range\"\r\n              min={offsetRange.min}\r\n              max={offsetRange.max}\r\n              step={offsetRange.step}\r\n              value={tenzOffset}\r\n              onChange={(e) => setTenzOffset(parseFloat(e.target.value))}\r\n              className=\"tenz-offset-slider\"\r\n            />\r\n            <input\r\n              type=\"number\"\r\n              min={offsetRange.min}\r\n              max={offsetRange.max}\r\n              step={offsetRange.step}\r\n              value={tenzOffset}\r\n              onChange={(e) =>\r\n                setTenzOffset(parseFloat(e.target.value) || 0)\r\n              }\r\n              className=\"tenz-offset-number\"\r\n            />\r\n            <button\r\n              type=\"button\"\r\n              className=\"tenz-offset-reset-btn\"\r\n              onClick={() => setTenzOffset(0)}\r\n              aria-label=\"Сбросить сдвиг\"\r\n            >\r\n              Сбросить\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n      <section className=\"chart-section\">\r\n        <div className=\"chart-controls-group\">\r\n          <div className=\"zoom-controls\" role=\"group\" aria-label=\"Управление масштабом\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"zoom-control-btn\"\r\n              onClick={handleZoomOriginalOut}\r\n              aria-label=\"Уменьшить масштаб\"\r\n            >\r\n              -\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              className=\"zoom-control-btn\"\r\n              onClick={handleZoomOriginalIn}\r\n              aria-label=\"Увеличить масштаб\"\r\n            >\r\n              +\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              className=\"zoom-reset-btn\"\r\n              onClick={handleResetOriginal}\r\n              aria-label=\"Сбросить масштаб\"\r\n            >\r\n              ↺ Сбросить\r\n            </button>\r\n          </div>\r\n        </div>\r\n        {originalAxisOptions.length > 0 && (\r\n          <div\r\n            className=\"axis-toggle-group\"\r\n            role=\"group\"\r\n            aria-label=\"Отображение осей исходных сигналов\"\r\n          >\r\n            {originalAxisOptions.map(({ label, color }) => {\r\n              const isActive = originalAxisVisibility[label] ?? true;\r\n              return (\r\n                <button\r\n                  key={label}\r\n                  type=\"button\"\r\n                  className={`axis-toggle-btn ${\r\n                    isActive ? \"axis-toggle-btn--active\" : \"\"\r\n                  }`}\r\n                  onClick={() =>\r\n                    handleAxisToggle(\r\n                      originalChartInstance,\r\n                      label,\r\n                      originalAxisVisibility,\r\n                      setOriginalAxisVisibility\r\n                    )\r\n                  }\r\n                  aria-pressed={isActive}\r\n                >\r\n                  <span\r\n                    className=\"axis-toggle-btn__indicator\"\r\n                    style={{\r\n                      borderColor: color,\r\n                      backgroundColor: isActive ? color : \"transparent\",\r\n                    }}\r\n                    aria-hidden=\"true\"\r\n                  />\r\n                  <span className=\"axis-toggle-btn__label\">{label}</span>\r\n                </button>\r\n              );\r\n            })}\r\n            {intersectionDataset && (\r\n              <button\r\n                type=\"button\"\r\n                className={`axis-toggle-btn ${\r\n                  intersectionVisibility ? \"axis-toggle-btn--active\" : \"\"\r\n                }`}\r\n                onClick={handleIntersectionToggle}\r\n                aria-pressed={intersectionVisibility}\r\n              >\r\n                <span\r\n                  className=\"axis-toggle-btn__indicator\"\r\n                  style={{\r\n                    borderColor: \"#000000\",\r\n                    backgroundColor: intersectionVisibility\r\n                      ? \"#000000\"\r\n                      : \"transparent\",\r\n                  }}\r\n                  aria-hidden=\"true\"\r\n                />\r\n                <span className=\"axis-toggle-btn__label\">\r\n                  {intersectionDataset.label}\r\n                </span>\r\n              </button>\r\n            )}\r\n          </div>\r\n        )}\r\n        <canvas ref={originalChartRef} width=\"800\" height=\"400\"></canvas>\r\n      </section>\r\n\r\n      <section className=\"chart-section\">\r\n        <div className=\"chart-controls-group\">\r\n          <div className=\"zoom-controls\" role=\"group\" aria-label=\"Управление масштабом\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"zoom-control-btn\"\r\n              onClick={handleZoomProcessedOut}\r\n              aria-label=\"Уменьшить масштаб\"\r\n            >\r\n              -\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              className=\"zoom-control-btn\"\r\n              onClick={handleZoomProcessedIn}\r\n              aria-label=\"Увеличить масштаб\"\r\n            >\r\n              +\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              className=\"zoom-reset-btn\"\r\n              onClick={handleResetProcessed}\r\n              aria-label=\"Сбросить масштаб\"\r\n            >\r\n              ↺ Сбросить\r\n            </button>\r\n          </div>\r\n        </div>\r\n        {processedAxisOptions.length > 0 && (\r\n          <div\r\n            className=\"axis-toggle-group\"\r\n            role=\"group\"\r\n            aria-label=\"Отображение осей обработанных сигналов\"\r\n          >\r\n            {processedAxisOptions.map(({ label, color }) => {\r\n              const isActive = processedAxisVisibility[label] ?? true;\r\n              return (\r\n                <button\r\n                  key={label}\r\n                  type=\"button\"\r\n                  className={`axis-toggle-btn ${\r\n                    isActive ? \"axis-toggle-btn--active\" : \"\"\r\n                  }`}\r\n                  onClick={() =>\r\n                    handleAxisToggle(\r\n                      processedChartInstance,\r\n                      label,\r\n                      processedAxisVisibility,\r\n                      setProcessedAxisVisibility\r\n                    )\r\n                  }\r\n                  aria-pressed={isActive}\r\n                >\r\n                  <span\r\n                    className=\"axis-toggle-btn__indicator\"\r\n                    style={{\r\n                      borderColor: color,\r\n                      backgroundColor: isActive ? color : \"transparent\",\r\n                    }}\r\n                    aria-hidden=\"true\"\r\n                  />\r\n                  <span className=\"axis-toggle-btn__label\">{label}</span>\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n        <canvas ref={processedChartRef} width=\"800\" height=\"400\"></canvas>\r\n      </section>\r\n      {currentIntersections.length > 0 && (\r\n        <aside className=\"intersection-panel\">\r\n          <div className=\"intersection-panel__header\">\r\n            <span className=\"chart-chip chart-chip--highlight\">\r\n              Пересечения Y={averageY.toFixed(4)}\r\n            </span>\r\n            <p>Общие точки tензо и интерферосигнала</p>\r\n          </div>\r\n          <div className=\"intersection-table-wrapper\">\r\n            <table className=\"intersection-table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>#</th>\r\n                  <th>Время (с)</th>\r\n                  <th>Амплитуда (В)</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {currentIntersections.map((point, idx) => (\r\n                  <tr key={`${point.time}-${idx}`}>\r\n                    <td>{idx + 1}</td>\r\n                    <td>{formatTime(point.time)}</td>\r\n                    <td>{formatSignal(point.value)}</td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </aside>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChartComponent;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}